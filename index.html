<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–≤—Ç–æ–º–∞—à–∏–Ω—ã –ë“Ø—Ä—Ç–≥—ç–ª–∏–π–Ω –°–∏—Å—Ç–µ–º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .hidden { display: none !important; }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            animation: slideIn 0.3s ease-out;
        }
        .notification.success { background-color: #10b981; }
        .notification.error { background-color: #ef4444; }
        .notification.info { background-color: #3b82f6; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Welcome Page -->
    <div id="welcomePage" class="min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-blue-800 to-purple-900">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-2xl">
            <div class="text-center mb-8">
                <div class="flex justify-center mb-6">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Emblem_of_the_Ministry_of_Foreign_Affairs_of_Mongolia.svg" 
                         alt="–ì–∞–¥–∞–∞–¥ —Ö–∞—Ä–∏–ª—Ü–∞–∞–Ω—ã —è–∞–º–Ω—ã —Å“Ø–ª–¥" 
                         class="h-30 w-30"
                         onerror="this.src=''; this.alt='Ministry emblem failed to load'; this.style.display='none';">
                </div>
                <h1 class="text-2xl font-bold text-gray-800 mb-6">–•–ò–õ–ò–ô–ù –ß–ê–ù–ê–î –î–ê–•–¨ –î–ò–ü–õ–û–ú–ê–¢ –¢”®–õ”®”®–õ”®–ì–ß–ò–ô–ù –ì–ê–ó–†–£–£–î–´–ù –¢–≠–≠–í–†–ò–ô–ù –•–≠–†–≠–ì–°–õ–ò–ô–ù –ë“Æ–†–¢–ì–≠–õ</h1>
                
                <!-- System Logos -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                    <div class="flex flex-col items-center p-4 bg-blue-50 rounded-lg">
                        <div class="text-3xl mb-2">üöó</div>
                        <p class="text-sm font-medium text-blue-700">–ê–≤—Ç–æ–º–∞—à–∏–Ω—ã –±“Ø—Ä—Ç–≥—ç–ª, —Ö–∞–π–ª—Ç—ã–Ω —Å–∏—Å—Ç–µ–º</p>
                    </div>
                    <div class="flex flex-col items-center p-4 bg-green-50 rounded-lg">
                        <div class="text-3xl mb-2">üîß</div>
                        <p class="text-sm font-medium text-green-700">–ó–∞—Å–≤–∞—Ä, “Ø–π–ª—á–∏–ª–≥—ç—ç, —ç–≤–¥—Ä—ç–ª –≥—ç–º—Ç–ª–∏–π–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–Ω —Å–∏—Å—Ç–µ–º</p>
                    </div>
                    <div class="flex flex-col items-center p-4 bg-purple-50 rounded-lg">
                        <div class="text-3xl mb-2">‚öôÔ∏è</div>
                        <p class="text-sm font-medium text-purple-700">–£–¥–∏—Ä–¥–ª–∞–≥—ã–Ω —Å–∏—Å—Ç–µ–º</p>
                    </div>
                </div>
            </div>
            
            <div class="space-y-4">
                <button onclick="showLogin()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                    –ù—ç–≤—Ç—Ä—ç—Ö
                </button>
                <button onclick="showRegister()" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                    –ë“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—Ö
                </button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">–ù—ç–≤—Ç—Ä—ç—Ö</h2>
                <button onclick="closeModal('loginModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form onsubmit="login(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä</label>
                        <input type="text" id="loginUsername" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ù—É—É—Ü “Ø–≥</label>
                        <input type="password" id="loginPassword" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        –ù—ç–≤—Ç—Ä—ç—Ö
                    </button>
                    <div class="text-center">
                        <button type="button" onclick="showForgotPassword()" class="text-blue-600 hover:text-blue-800 text-sm">
                            –ù—É—É—Ü “Ø–≥—ç—ç –º–∞—Ä—Ç—Å–∞–Ω —É—É?
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">–ë“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—Ö</h2>
                <button onclick="closeModal('registerModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form onsubmit="register(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä</label>
                        <input type="text" id="regUsername" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ò-–º—ç–π–ª</label>
                        <input type="email" id="regEmail" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ù—É—É—Ü “Ø–≥</label>
                        <input type="password" id="regPassword" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="isAdmin" onchange="toggleAdminCode()" class="mr-2">
                        <label for="isAdmin" class="text-sm text-gray-700">–ê–¥–º–∏–Ω —ç—Ä—Ö —Ö“Ø—Å—ç—Ö</label>
                    </div>
                    <div id="adminCodeSection" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ê–¥–º–∏–Ω –∫–æ–¥</label>
                        <input type="password" id="adminCode" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        –ë“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—Ö
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" class="modal hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">–ù—É—É—Ü “Ø–≥ —Å—ç—Ä–≥—ç—ç—Ö</h2>
                <button onclick="closeModal('forgotPasswordModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form onsubmit="forgotPassword(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ò-–º—ç–π–ª —Ö–∞—è–≥</label>
                        <input type="email" id="forgotEmail" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <button type="submit" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        –°—ç—Ä–≥—ç—ç—Ö
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Car Details Modal -->
    <div id="carDetailsModal" class="modal hidden">
        <div class="modal-content max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">–ú–∞—à–∏–Ω—ã –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π –º—ç–¥—ç—ç–ª—ç–ª</h2>
                <button onclick="closeModal('carDetailsModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div id="carDetailsContent">
                <!-- Car details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- User Page -->
    <div id="userPage" class="hidden min-h-screen bg-gray-50">
        <!-- User Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <h1 class="text-2xl font-bold text-gray-900">üöó –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —Ö—É—É–¥–∞—Å</h1>
                        <span id="userWelcome" class="ml-4 text-gray-600"></span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div id="userNotifications" class="relative">
                            <button onclick="toggleNotifications()" class="relative p-2 text-gray-600 hover:text-gray-900">
                                üîî
                                <span id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1 hidden">0</span>
                            </button>
                        </div>
                        <button onclick="logout()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition duration-200">
                            –ì–∞—Ä–∞—Ö
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- User Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="showUserSection('carRegister')" class="user-nav-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium">
                        –ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Ö
                    </button>
                    <button onclick="showUserSection('maintenance')" class="user-nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                        –ó–∞—Å–≤–∞—Ä, –≥—ç–º—Ç–ª–∏–π–Ω —Ç–∞–π–ª–∞–Ω
                    </button>
                </div>
            </div>
        </nav>

        <!-- Car Registration Section -->
        <div id="carRegisterSection" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Car Registration Form -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">–ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Ö</h2>
                    <form onsubmit="registerCar(event)" class="space-y-4">
                        <!-- Step 1: Region -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">1. –ë“Ø—Å –Ω—É—Ç–∞–≥</label>
                            <select id="carRegion" onchange="updateCountries()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Å –Ω—É—Ç–∞–≥ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                <option value="Asia">–ê–∑–∏</option>
                                <option value="Europe">–ï–≤—Ä–æ–ø</option>
                                <option value="North America">–•–æ–π–¥ –ê–º–µ—Ä–∏–∫</option>
                                <option value="South America">”®–º–Ω”©–¥ –ê–º–µ—Ä–∏–∫</option>
                                <option value="Africa">–ê—Ñ—Ä–∏–∫</option>
                                <option value="Oceania">–ê–≤—Å—Ç—Ä–∞–ª–∏ –±–∞ –û–∫–µ–∞–Ω–∏</option>
                            </select>
                        </div>
                        
                        <!-- Step 2: Country -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">2. –£–ª—Å</label>
                            <select id="carCountry" onchange="updateCities()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–≠—Ö–ª—ç—ç–¥ –±“Ø—Å –Ω—É—Ç–∞–≥ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                            </select>
                        </div>
                        
                        <!-- Step 3: City -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">3. –•–æ—Ç</label>
                            <select id="carCity" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–≠—Ö–ª—ç—ç–¥ —É–ª—Å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                            </select>
                        </div>
                        
                        <!-- Step 4: Organization -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">4. –ë–∞–π–≥—É—É–ª–ª–∞–≥–∞</label>
                            <select id="carOrganization" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                <option value="embassy">–≠–ª—á–∏–Ω —Å–∞–π–¥—ã–Ω —è–∞–º</option>
                                <option value="consulate-general">–ï—Ä”©–Ω—Ö–∏–π –∫–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä</option>
                                <option value="consulate">–ö–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä</option>
                                <option value="other">–ë—É—Å–∞–¥</option>
                            </select>
                        </div>
                        
                        <!-- Car Details -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫</label>
                                <select id="carBrand" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞–≥–≤–∞—Ä</label>
                                <input type="text" id="carModel" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä</label>
                                <input type="text" id="carPlateNumber" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ê—Ä–ª—ã–Ω –¥—É–≥–∞–∞—Ä</label>
                                <input type="text" id="carRegNumber" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">”®–Ω–≥”©</label>
                            <select id="carColor" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">”®–Ω–≥”© —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                <option value="–¶–∞–≥–∞–∞–Ω">–¶–∞–≥–∞–∞–Ω</option>
                                <option value="–•–∞—Ä">–•–∞—Ä</option>
                                <option value="–°–∞–∞—Ä–∞–ª">–°–∞–∞—Ä–∞–ª</option>
                                <option value="–¶—ç–Ω—Ö—ç—Ä">–¶—ç–Ω—Ö—ç—Ä</option>
                                <option value="–£–ª–∞–∞–Ω">–£–ª–∞–∞–Ω</option>
                                <option value="–ù–æ–≥–æ–æ–Ω">–ù–æ–≥–æ–æ–Ω</option>
                                <option value="–®–∞—Ä">–®–∞—Ä</option>
                                <option value="–•”©—Ö">–•”©—Ö</option>
                                <option value="–Ø–≥–∞–∞–Ω">–Ø–≥–∞–∞–Ω</option>
                                <option value="–•“Ø—Ä—ç–Ω">–•“Ø—Ä—ç–Ω</option>
                                <option value="–ê–ª—Ç–ª–∞–≥">–ê–ª—Ç–ª–∞–≥</option>
                                <option value="–ú”©–Ω–≥”©–ª”©–≥">–ú”©–Ω–≥”©–ª”©–≥</option>
                                <option value="–•–∞—Ä –º–µ—Ç–∞–ª–ª–∏–∫">–•–∞—Ä –º–µ—Ç–∞–ª–ª–∏–∫</option>
                                <option value="–¶–∞–≥–∞–∞–Ω –º–µ—Ç–∞–ª–ª–∏–∫">–¶–∞–≥–∞–∞–Ω –º–µ—Ç–∞–ª–ª–∏–∫</option>
                                <option value="–ë—É—Å–∞–¥">–ë—É—Å–∞–¥</option>
                            </select>
                        </div>
                        
                        <!-- Step 5: Usage Type -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">5. –ê—à–∏–≥–ª–∞–ª—Ç</label>
                            <select id="carUsage" onchange="toggleUsageFields()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                <option value="state">–¢”©—Ä–∏–π–Ω ”©–º—á</option>
                                <option value="individual">–•—É–≤–∏–π–Ω</option>
                            </select>
                        </div>
                        
                        <!-- State Property Fields -->
                        <div id="stateFields" class="hidden space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">–ì“Ø–π–ª—Ç (–∫–º)</label>
                                    <input type="number" id="carMileage" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">–ê–Ω—Ö–Ω—ã “Ø–Ω—ç–ª–≥—ç—ç (USD)</label>
                                    <input type="number" id="carInitialValuation" onchange="calculateCurrentValuation()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <!-- Purchase Date -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω –æ–≥–Ω–æ–æ</label>
                                <input type="date" id="carPurchaseDate" onchange="calculateCurrentValuation()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <!-- Auto-calculated fields -->
                            <div id="calculatedFields" class="hidden bg-gray-50 p-4 rounded-lg space-y-3">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">–û–¥–æ–æ–≥–∏–π–Ω “Ø–Ω—ç–ª–≥—ç—ç (USD)</label>
                                        <input type="number" id="carCurrentValuation" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">–•—É—Ä–∏–º—Ç–ª–∞–≥–¥—Å–∞–Ω —ç–ª—ç–≥–¥—ç–ª (USD)</label>
                                        <input type="number" id="carAccumulatedDepreciation" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600">
                                    </div>
                                </div>
                                <div id="depreciationInfo" class="text-sm p-3 rounded">
                                    <!-- Car age, depreciation percentage, and status will be shown here -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Individual Property Fields -->
                        <div id="individualFields" class="hidden space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–≠–∑—ç–º—à–∏–≥—á–∏–π–Ω –Ω—ç—Ä</label>
                                <input type="text" id="carOwnerName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω –æ–≥–Ω–æ–æ</label>
                                <input type="date" id="carPurchaseDateIndividual" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞—à–∏–Ω—ã –∑—É—Ä–∞–≥</label>
                            <input type="file" id="carPhoto" accept="image/*" onchange="previewCarPhoto()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <div id="photoPreview" class="mt-2 hidden">
                                <img id="previewImage" src="" alt="–ú–∞—à–∏–Ω—ã –∑—É—Ä–∞–≥" class="w-32 h-24 object-cover rounded-lg border">
                            </div>
                        </div>
                        
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                            –ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Ö
                        </button>
                    </form>
                </div>

                <!-- User's Cars List -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">–ú–∏–Ω–∏–π –º–∞—à–∏–Ω—É—É–¥</h2>
                    <div id="userCarsList" class="space-y-4">
                        <!-- Cars will be displayed here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Maintenance Section -->
        <div id="maintenanceSection" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Maintenance Form -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">–ó–∞—Å–≤–∞—Ä, –≥—ç–º—Ç–ª–∏–π–Ω —Ç–∞–π–ª–∞–Ω</h2>
                    <form onsubmit="addMaintenance(event)" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞—à–∏–Ω —Å–æ–Ω–≥–æ—Ö</label>
                            <select id="maintenanceCarSelect" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ú–∞—à–∏–Ω —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–¢”©—Ä”©–ª</label>
                            <select id="maintenanceType" onchange="updateMaintenanceSubcategory()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                <option value="maintenance">–ó–∞—Å–≤–∞—Ä</option>
                                <option value="damage">–ì—ç–º—Ç—ç–ª</option>
                            </select>
                        </div>
                        <div id="maintenanceSubcategoryDiv" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–î—ç–¥ —Ç”©—Ä”©–ª</label>
                            <select id="maintenanceSubcategory" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                            </select>
                        </div>
                        <div id="damageStatusDiv" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂</label>
                            <select id="damageStatus" onchange="updateDamageStatusFields()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                <option value="usable">–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π</option>
                                <option value="unusable">–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π</option>
                            </select>
                        </div>
                        <div id="estimatedPriceDiv" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–¢–æ–æ—Ü–æ–æ–ª—Å–æ–Ω “Ø–Ω—ç (USD)</label>
                            <input type="number" id="estimatedPrice" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div id="unusableDetailsDiv" class="hidden">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ù—ç–º—ç–ª—Ç —Ç–∞–π–ª–±–∞—Ä</label>
                                <textarea id="additionalDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π –±–æ–ª—Å–æ–Ω —à–∞–ª—Ç–≥–∞–∞–Ω—ã–≥ –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π –±–∏—á–Ω—ç “Ø“Ø..."></textarea>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ù—ç–º—ç–ª—Ç –∑—É—Ä–∞–≥</label>
                                <input type="file" id="additionalPhoto" accept="image/*" onchange="previewAdditionalPhoto()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <div id="additionalPhotoPreview" class="mt-2 hidden">
                                    <img id="additionalPreviewImage" src="" alt="–ù—ç–º—ç–ª—Ç –∑—É—Ä–∞–≥" class="w-32 h-24 object-cover rounded-lg border">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">”®–º—á —Ö–∞–º–≥–∞–∞–ª–ª—ã–Ω –∑”©–≤–ª”©–ª–∏–π–Ω —Ö—É—Ä–ª—ã–Ω —Ç—ç–º–¥—ç–≥–ª—ç–ª–∏–π–≥ –æ—Ä—É—É–ª–Ω–∞ —É—É</label>
                                <input type="file" id="councilDocument" accept=".pdf,.doc,.docx,.txt" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <p class="text-xs text-gray-500 mt-1">PDF, DOC, DOCX, TXT —Ñ–∞–π–ª –æ—Ä—É—É–ª–Ω–∞ —É—É</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–¢–∞–π–ª–±–∞—Ä</label>
                            <textarea id="maintenanceDescription" required rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞—Ä–¥–∞–ª (USD)</label>
                            <input type="number" id="maintenanceCost" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–û–≥–Ω–æ–æ</label>
                            <input type="date" id="maintenanceDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ó—É—Ä–∞–≥</label>
                            <input type="file" id="maintenancePhoto" accept="image/*" onchange="previewMaintenancePhoto()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <div id="maintenancePhotoPreview" class="mt-2 hidden">
                                <img id="maintenancePreviewImage" src="" alt="–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª–∏–π–Ω –∑—É—Ä–∞–≥" class="w-32 h-24 object-cover rounded-lg border">
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                            –ù—ç–º—ç—Ö
                        </button>
                    </form>
                </div>

                <!-- Maintenance History -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">–ó–∞—Å–≤–∞—Ä, –≥—ç–º—Ç–ª–∏–π–Ω —Ç“Ø“Ø—Ö</h2>
                    <div id="maintenanceHistory" class="space-y-4">
                        <!-- Maintenance history will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Page -->
    <div id="adminPage" class="hidden min-h-screen bg-gray-50">
        <!-- Admin Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <h1 class="text-2xl font-bold text-gray-900">üëë –ê–¥–º–∏–Ω —Ö—É—É–¥–∞—Å</h1>
                        <span id="adminWelcome" class="ml-4 text-gray-600"></span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div id="adminNotifications" class="relative">
                            <button onclick="toggleAdminNotifications()" class="relative p-2 text-gray-600 hover:text-gray-900">
                                üîî
                                <span id="adminNotificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1 hidden">0</span>
                            </button>
                        </div>
                        <button onclick="logout()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition duration-200">
                            –ì–∞—Ä–∞—Ö
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Admin Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8 overflow-x-auto">
                    <button onclick="showAdminSection('dashboard')" class="admin-nav-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium whitespace-nowrap">
                        üìä –•—è–Ω–∞–ª—Ç—ã–Ω —Å–∞–º–±–∞—Ä
                    </button>
                    <button onclick="showAdminSection('cars')" class="admin-nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium whitespace-nowrap">
                        –ú–∞—à–∏–Ω—É—É–¥
                    </button>
                    <button onclick="showAdminSection('adminMaintenance')" class="admin-nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium whitespace-nowrap">
                        –ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª
                    </button>
                    <button onclick="showAdminSection('users')" class="admin-nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium whitespace-nowrap">
                        –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥
                    </button>
                    <button onclick="showAdminSection('valuation')" class="admin-nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium whitespace-nowrap">
                        “Æ–Ω—ç–ª–≥—ç—ç
                    </button>
                </div>
            </div>
        </nav>



        <!-- Dashboard Section -->
        <div id="dashboardSection" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

            <!-- Country Details Modal -->
            <div id="countryDetailsModal" class="modal hidden">
                <div class="modal-content max-w-4xl">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="countryModalTitle" class="text-2xl font-bold text-gray-800">–£–ª—Å—ã–Ω –º–∞—à–∏–Ω—É—É–¥—ã–Ω –º—ç–¥—ç—ç–ª—ç–ª</h2>
                        <button onclick="closeModal('countryDetailsModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    <div id="countryDetailsContent">
                        <!-- Country car details will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Key Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6 mb-8">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm font-medium">–ù–∏–π—Ç –º–∞—à–∏–Ω</p>
                            <p id="totalCars" class="text-3xl font-bold">0</p>
                        </div>
                        <div class="bg-blue-400 bg-opacity-30 rounded-full p-3">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
                                <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm">
                            <span class="text-green-200">‚ÜóÔ∏è</span>
                            <span class="ml-1 text-blue-100">–ò–¥—ç–≤—Ö—Ç—ç–π</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm font-medium">–û–¥–æ–æ–≥–∏–π–Ω –Ω–∏–π—Ç “Ø–Ω—ç–ª–≥—ç—ç</p>
                            <p id="totalValuation" class="text-3xl font-bold">$0</p>
                        </div>
                        <div class="bg-green-400 bg-opacity-30 rounded-full p-3">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"/>
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm">
                            <span class="text-green-200">üí∞</span>
                            <span class="ml-1 text-green-100">–ë–æ–¥–∏—Ç —Ü–∞–≥–∏–π–Ω “Ø–Ω—ç–ª–≥—ç—ç</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-red-500 to-red-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-red-100 text-sm font-medium">–ù–∏–π—Ç —ç–ª—ç–≥–¥—ç–ª</p>
                            <p id="totalDepreciation" class="text-3xl font-bold">$0</p>
                        </div>
                        <div class="bg-red-400 bg-opacity-30 rounded-full p-3">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 01-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm">
                            <span class="text-red-200">üìâ</span>
                            <span class="ml-1 text-red-100">–•—É—Ä–∏–º—Ç–ª–∞–≥–¥—Å–∞–Ω —ç–ª—ç–≥–¥—ç–ª</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-yellow-100 text-sm font-medium">–•—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω</p>
                            <p id="expiredCars" class="text-3xl font-bold">0</p>
                        </div>
                        <div class="bg-yellow-400 bg-opacity-30 rounded-full p-3">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm">
                            <span class="text-red-200">‚ö†Ô∏è</span>
                            <span class="ml-1 text-yellow-100">–ê–Ω—Ö–∞–∞—Ä–∞–ª —Ö—ç—Ä—ç–≥—Ç—ç–π</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm font-medium">–ó–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª</p>
                            <p id="totalMaintenanceCost" class="text-3xl font-bold">$0</p>
                        </div>
                        <div class="bg-purple-400 bg-opacity-30 rounded-full p-3">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm">
                            <span class="text-purple-200">üîß</span>
                            <span class="ml-1 text-purple-100">–°“Ø“Ø–ª–∏–π–Ω —Å–∞—Ä–¥</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts and Analytics -->
            <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 mb-8">
                <!-- Car Distribution Chart -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-800">–ú–∞—à–∏–Ω—ã —Ç–∞—Ä—Ö–∞–ª—Ç</h3>
                        <div class="flex space-x-2">
                            <button onclick="updateChartView('region')" class="chart-btn bg-blue-100 text-blue-700 px-3 py-1 rounded-lg text-sm font-medium">
                                –ë“Ø—Å –Ω—É—Ç–≥–∞–∞—Ä
                            </button>
                            <button onclick="updateChartView('brand')" class="chart-btn bg-gray-100 text-gray-700 px-3 py-1 rounded-lg text-sm font-medium">
                                –ú–∞—Ä–∫–∞–∞—Ä
                            </button>
                        </div>
                    </div>
                    <div class="relative h-80">
                        <canvas id="distributionChart"></canvas>
                    </div>
                </div>

                <!-- Age Distribution -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-6">–ú–∞—à–∏–Ω—ã –Ω–∞—Å–Ω—ã —Ç–∞—Ä—Ö–∞–ª—Ç</h3>
                    <div class="relative h-80">
                        <canvas id="ageChart"></canvas>
                    </div>
                </div>

                <!-- Valuation and Depreciation Chart -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-6">“Æ–Ω—ç–ª–≥—ç—ç –±–∞ –≠–ª—ç–≥–¥—ç–ª</h3>
                    <div class="relative h-80">
                        <canvas id="valuationChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Activity and Alerts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Recent Activity -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-6">–°“Ø“Ø–ª–∏–π–Ω “Ø–π–ª –∞–∂–∏–ª–ª–∞–≥–∞–∞</h3>
                    <div id="recentActivity" class="space-y-4 max-h-96 overflow-y-auto">
                        <!-- Recent activities will be loaded here -->
                    </div>
                </div>

                <!-- System Alerts -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-6">–°–∏—Å—Ç–µ–º–∏–π–Ω –∞–Ω—Ö–∞–∞—Ä—É—É–ª–≥–∞</h3>
                    <div id="systemAlerts" class="space-y-4 max-h-96 overflow-y-auto">
                        <!-- System alerts will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="mt-8 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold text-white mb-6">“Æ–π–ª–¥—ç–ª</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button onclick="showAdminSection('cars')" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-lg p-4 transition duration-200 text-center">
                        <div class="text-2xl mb-2">üöó</div>
                        <div class="text-sm font-medium">–ú–∞—à–∏–Ω –Ω—ç–º—ç—Ö</div>
                    </button>
                    <button onclick="generateReport()" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-lg p-4 transition duration-200 text-center">
                        <div class="text-2xl mb-2">üìä</div>
                        <div class="text-sm font-medium">–¢–∞–π–ª–∞–Ω –≥–∞—Ä–≥–∞—Ö</div>
                    </button>
                    <button onclick="exportData()" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-lg p-4 transition duration-200 text-center">
                        <div class="text-2xl mb-2">üì§</div>
                        <div class="text-sm font-medium">”®–≥”©–≥–¥”©–ª —ç–∫—Å–ø–æ—Ä—Ç</div>
                    </button>
                    <button onclick="showAdminSection('users')" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-lg p-4 transition duration-200 text-center">
                        <div class="text-2xl mb-2">üë•</div>
                        <div class="text-sm font-medium">–•—ç—Ä—ç–≥–ª—ç–≥—á —É–¥–∏—Ä–¥–∞—Ö</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Cars Management Section -->
        <div id="carsSection" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Admin Car Registration Form -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">–ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Ö (–ê–¥–º–∏–Ω)</h2>
                    <button onclick="toggleAdminCarForm()" id="toggleFormBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200">
                        + –ú–∞—à–∏–Ω –Ω—ç–º—ç—Ö
                    </button>
                </div>
                
                <div id="adminCarForm" class="hidden">
                    <form onsubmit="adminRegisterCar(event)" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–•—ç—Ä—ç–≥–ª—ç–≥—á —Å–æ–Ω–≥–æ—Ö</label>
                                <select id="adminCarUser" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–•—ç—Ä—ç–≥–ª—ç–≥—á —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ë“Ø—Å –Ω—É—Ç–∞–≥</label>
                                <select id="adminCarRegion" onchange="updateAdminCountries()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–ë“Ø—Å –Ω—É—Ç–∞–≥ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                    <option value="Asia">–ê–∑–∏</option>
                                    <option value="Europe">–ï–≤—Ä–æ–ø</option>
                                    <option value="North America">–•–æ–π–¥ –ê–º–µ—Ä–∏–∫</option>
                                    <option value="South America">”®–º–Ω”©–¥ –ê–º–µ—Ä–∏–∫</option>
                                    <option value="Africa">–ê—Ñ—Ä–∏–∫</option>
                                    <option value="Oceania">–ê–≤—Å—Ç—Ä–∞–ª–∏ –±–∞ –û–∫–µ–∞–Ω–∏</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–£–ª—Å</label>
                                <select id="adminCarCountry" onchange="updateAdminCities()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–≠—Ö–ª—ç—ç–¥ –±“Ø—Å –Ω—É—Ç–∞–≥ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–•–æ—Ç</label>
                                <select id="adminCarCity" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–≠—Ö–ª—ç—ç–¥ —É–ª—Å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞</label>
                                <select id="adminCarOrganization" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                    <option value="embassy">–≠–ª—á–∏–Ω —Å–∞–π–¥—ã–Ω —è–∞–º</option>
                                    <option value="consulate-general">–ï—Ä”©–Ω—Ö–∏–π –∫–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä</option>
                                    <option value="consulate">–ö–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä</option>
                                    <option value="other">–ë—É—Å–∞–¥</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫</label>
                                <select id="adminCarBrand" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞–≥–≤–∞—Ä</label>
                                <input type="text" id="adminCarModel" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä</label>
                                <input type="text" id="adminCarPlateNumber" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ê—Ä–ª—ã–Ω –¥—É–≥–∞–∞—Ä</label>
                                <input type="text" id="adminCarRegNumber" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">”®–Ω–≥”©</label>
                                <select id="adminCarColor" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">”®–Ω–≥”© —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                    <option value="–¶–∞–≥–∞–∞–Ω">–¶–∞–≥–∞–∞–Ω</option>
                                    <option value="–•–∞—Ä">–•–∞—Ä</option>
                                    <option value="–°–∞–∞—Ä–∞–ª">–°–∞–∞—Ä–∞–ª</option>
                                    <option value="–¶—ç–Ω—Ö—ç—Ä">–¶—ç–Ω—Ö—ç—Ä</option>
                                    <option value="–£–ª–∞–∞–Ω">–£–ª–∞–∞–Ω</option>
                                    <option value="–ù–æ–≥–æ–æ–Ω">–ù–æ–≥–æ–æ–Ω</option>
                                    <option value="–®–∞—Ä">–®–∞—Ä</option>
                                    <option value="–•”©—Ö">–•”©—Ö</option>
                                    <option value="–Ø–≥–∞–∞–Ω">–Ø–≥–∞–∞–Ω</option>
                                    <option value="–•“Ø—Ä—ç–Ω">–•“Ø—Ä—ç–Ω</option>
                                    <option value="–ê–ª—Ç–ª–∞–≥">–ê–ª—Ç–ª–∞–≥</option>
                                    <option value="–ú”©–Ω–≥”©–ª”©–≥">–ú”©–Ω–≥”©–ª”©–≥</option>
                                    <option value="–•–∞—Ä –º–µ—Ç–∞–ª–ª–∏–∫">–•–∞—Ä –º–µ—Ç–∞–ª–ª–∏–∫</option>
                                    <option value="–¶–∞–≥–∞–∞–Ω –º–µ—Ç–∞–ª–ª–∏–∫">–¶–∞–≥–∞–∞–Ω –º–µ—Ç–∞–ª–ª–∏–∫</option>
                                    <option value="–ë—É—Å–∞–¥">–ë—É—Å–∞–¥</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω –æ–≥–Ω–æ–æ</label>
                                <input type="date" id="adminCarPurchaseDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ê—à–∏–≥–ª–∞–ª—Ç</label>
                                <select id="adminCarUsage" onchange="toggleAdminUsageFields()" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                    <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
                                    <option value="state">–¢”©—Ä–∏–π–Ω ”©–º—á</option>
                                    <option value="individual">–•—É–≤–∏–π–Ω</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="adminStateFields" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ì“Ø–π–ª—Ç (–∫–º)</label>
                                <input type="number" id="adminCarMileage" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">“Æ–Ω—ç–ª–≥—ç—ç (USD)</label>
                                <input type="number" id="adminCarValuation" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div id="adminIndividualFields" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–≠–∑—ç–º—à–∏–≥—á–∏–π–Ω –Ω—ç—Ä</label>
                            <input type="text" id="adminCarOwnerName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞—à–∏–Ω—ã –∑—É—Ä–∞–≥</label>
                            <input type="file" id="adminCarPhoto" accept="image/*" onchange="previewAdminCarPhoto()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <div id="adminPhotoPreview" class="mt-2 hidden">
                                <img id="adminPreviewImage" src="" alt="–ú–∞—à–∏–Ω—ã –∑—É—Ä–∞–≥" class="w-32 h-24 object-cover rounded-lg border">
                            </div>
                        </div>
                        
                        <div class="flex space-x-4">
                            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-200">
                                –ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Ö
                            </button>
                            <button type="button" onclick="cancelAdminCarForm()" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-200">
                                –¶—É—Ü–ª–∞—Ö
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Cars List with Advanced Search -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">–¢—ç—ç–≤—Ä–∏–π–Ω —Ö—ç—Ä—ç–≥—Å–ª–∏–π–Ω –±“Ø—Ä—Ç–≥—ç–ª</h2>
                    <button onclick="resetCarSearch()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition duration-200">
                        –•–∞–π–ª—Ç —Ü—ç–≤—ç—Ä–ª—ç—Ö
                    </button>
                </div>
                
                <!-- Advanced Search Filters -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">–•–∞–π–ª—Ç—ã–Ω —à“Ø“Ø–ª—Ç“Ø“Ø—Ä</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä</label>
                            <input type="text" id="searchPlateNumber" placeholder="–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ë–∞–π—Ä—à–∏–ª</label>
                            <select id="searchLocation" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö –±–∞–π—Ä—à–∏–ª</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞</label>
                            <select id="searchOrganization" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö –±–∞–π–≥—É—É–ª–ª–∞–≥–∞</option>
                                <option value="embassy">–≠–ª—á–∏–Ω —Å–∞–π–¥—ã–Ω —è–∞–º</option>
                                <option value="consulate-general">–ï—Ä”©–Ω—Ö–∏–π –∫–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä</option>
                                <option value="consulate">–ö–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä</option>
                                <option value="other">–ë—É—Å–∞–¥</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–≠–∑—ç–º—à–∏–≥—á</label>
                            <select id="searchOwner" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö —ç–∑—ç–º—à–∏–≥—á</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mt-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫</label>
                            <select id="searchBrand" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö –º–∞—Ä–∫</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ê—à–∏–≥–ª–∞–ª—Ç</label>
                            <select id="searchUsage" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö —Ç”©—Ä”©–ª</option>
                                <option value="state">–¢”©—Ä–∏–π–Ω ”©–º—á</option>
                                <option value="individual">–•—É–≤–∏–π–Ω</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">“Æ–Ω—ç–ª–≥—ç—ç (USD)</label>
                            <select id="searchValuation" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö “Ø–Ω—ç–ª–≥—ç—ç</option>
                                <option value="0-10000">$0 - $10,000</option>
                                <option value="10000-25000">$10,000 - $25,000</option>
                                <option value="25000-50000">$25,000 - $50,000</option>
                                <option value="50000+">$50,000+</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ê—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞</label>
                            <select id="searchExpired" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                <option value="">–ë“Ø—Ö –º–∞—à–∏–Ω</option>
                                <option value="expired">–ê—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω</option>
                                <option value="active">–ò–¥—ç–≤—Ö—Ç—ç–π –º–∞—à–∏–Ω—É—É–¥</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button onclick="performAdvancedSearch()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200">
                                –•–∞–π—Ö
                            </button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ó—É—Ä–∞–≥</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ë–∞–π—Ä—à–∏–ª</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">“Æ–Ω—ç–ª–≥—ç—ç</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">“Æ–π–ª–¥—ç–ª</th>
                            </tr>
                        </thead>
                        <tbody id="adminCarsTable" class="bg-white divide-y divide-gray-200">
                            <!-- Cars will be displayed here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Admin Maintenance Section -->
        <div id="adminMaintenanceSection" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6">–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ú–∞—à–∏–Ω</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–¢”©—Ä”©–ª</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–¢–∞–π–ª–±–∞—Ä</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ó–∞—Ä–¥–∞–ª</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–û–≥–Ω–æ–æ</th>
                            </tr>
                        </thead>
                        <tbody id="adminMaintenanceTable" class="bg-white divide-y divide-gray-200">
                            <!-- Maintenance records will be displayed here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Users Management Section -->
        <div id="usersSection" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6">–•—ç—Ä—ç–≥–ª—ç–≥—á–¥–∏–π–Ω —É–¥–∏—Ä–¥–ª–∞–≥–∞</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ò-–º—ç–π–ª</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–≠—Ä—Ö</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ë“Ø—Ä—Ç–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">“Æ–π–ª–¥—ç–ª</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable" class="bg-white divide-y divide-gray-200">
                            <!-- Users will be displayed here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- User Activity Logs -->
            <div class="bg-white rounded-lg shadow-md p-6 mt-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6">–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω “Ø–π–ª –∞–∂–∏–ª–ª–∞–≥–∞–∞</h2>
                <div id="userLogs" class="space-y-2 max-h-96 overflow-y-auto">
                    <!-- User logs will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Valuation Section -->
        <div id="valuationSection" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">“Æ–Ω—ç–ª–≥—ç—ç–Ω–∏–π –º—ç–¥—ç—ç–ª—ç–ª</h2>
                    <div class="flex space-x-4">
                        <select id="valuationFilter" onchange="filterValuation()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="all">–ë“Ø–≥–¥</option>
                            <option value="old">5 –∂–∏–ª—ç—ç—Å –¥—ç—ç—à</option>
                            <option value="new">5 –∂–∏–ª—ç—ç—Å –¥–æ–æ—à</option>
                        </select>
                        <input type="text" id="valuationSearchInput" placeholder="–•–∞–π—Ö..." class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <button onclick="searchValuation()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200">
                            –•–∞–π—Ö
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ú–∞—à–∏–Ω</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">“Æ–Ω—ç–ª–≥—ç—ç</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω –æ–≥–Ω–æ–æ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ù–∞—Å</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ó–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª</th>
                            </tr>
                        </thead>
                        <tbody id="valuationTable" class="bg-white divide-y divide-gray-200">
                            <!-- Valuation data will be displayed here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('carSystemUsers') || '[]');
        let cars = JSON.parse(localStorage.getItem('carSystemCars') || '[]');
        let maintenance = JSON.parse(localStorage.getItem('carSystemMaintenance') || '[]');
        let userLogs = JSON.parse(localStorage.getItem('carSystemLogs') || '[]');
        let notifications = JSON.parse(localStorage.getItem('carSystemNotifications') || '[]');

        // Dropdown data
        const regionData = {
            'Asia': {
                'China': ['Beijing', 'Shanghai','Erlian', 'Huhhot', 'Manzhouli', 'Hong Kong', 'Taiwan'],
                'Japan': ['Tokyo', 'Osaka', 'Kyoto', 'Yokohama', 'Kobe', 'Nagoya', 'Sapporo'],
                'South Korea': ['Seoul', 'Busan', 'Incheon', 'Daegu', 'Daejeon', 'Gwangju'],
                'North Korea': ['Pyongyang'],
                'India': ['New Delhi', 'Mumbai', 'Bangalore', 'Chennai', 'Kolkata', 'Hyderabad'],
                'Pakistan': ['Islamabad', 'Karachi', 'Lahore', 'Faisalabad', 'Rawalpindi'],
                'Bangladesh': ['Dhaka', 'Chittagong', 'Sylhet', 'Rajshahi', 'Khulna'],
                'Sri Lanka': ['Colombo', 'Kandy', 'Galle', 'Jaffna', 'Negombo'],
                'Nepal': ['Kathmandu', 'Pokhara', 'Lalitpur', 'Bharatpur', 'Biratnagar'],
                'Afghanistan': ['Kabul', 'Kandahar', 'Herat', 'Mazar-i-Sharif', 'Jalalabad'],
                'Kazakhstan': ['Almaty', 'Nur-Sultan', 'Shymkent', 'Aktobe', 'Taraz'],
                'Uzbekistan': ['Tashkent', 'Samarkand', 'Namangan', 'Andijan', 'Bukhara'],
                'Kyrgyzstan': ['Bishkek', 'Osh', 'Jalal-Abad', 'Karakol', 'Tokmok'],
                'Tajikistan': ['Dushanbe', 'Khujand', 'Kulob', 'Qurghonteppa', 'Istaravshan'],
                'Turkmenistan': ['Ashgabat', 'Turkmenbashi', 'Dashoguz', 'Mary', 'Balkanabat'],
                'Turkey': ['Istanbul', 'Ankara', 'Izmir', 'Bursa', 'Antalya', 'Adana', 'Konya'],
                'Iran': ['Tehran', 'Mashhad', 'Isfahan', 'Karaj', 'Shiraz', 'Tabriz'],
                'Iraq': ['Baghdad', 'Basra', 'Mosul', 'Erbil', 'Najaf', 'Karbala'],
                'Syria': ['Damascus', 'Aleppo', 'Homs', 'Latakia', 'Hama'],
                'Jordan': ['Amman', 'Zarqa', 'Irbid', 'Russeifa', 'Wadi as-Sir'],
                'Lebanon': ['Beirut', 'Tripoli', 'Sidon', 'Tyre', 'Nabatieh'],
                'Israel': ['Jerusalem', 'Tel Aviv', 'Haifa', 'Rishon LeZion', 'Petah Tikva'],
                'Palestine': ['Gaza', 'Ramallah', 'Hebron', 'Nablus', 'Bethlehem'],
                'Saudi Arabia': ['Riyadh', 'Jeddah', 'Mecca', 'Medina', 'Dammam'],
                'UAE': ['Dubai', 'Abu Dhabi', 'Sharjah', 'Al Ain', 'Ajman'],
                'Qatar': ['Doha', 'Al Rayyan', 'Umm Salal', 'Al Wakrah', 'Al Khor'],
                'Kuwait': ['Kuwait City', 'Al Ahmadi', 'Hawalli', 'As Salimiyah', 'Sabah as Salim'],
                'Bahrain': ['Manama', 'Riffa', 'Muharraq', 'Hamad Town', 'A\'ali'],
                'Oman': ['Muscat', 'Seeb', 'Salalah', 'Bawshar', 'Sohar'],
                'Yemen': ['Sanaa', 'Aden', 'Taiz', 'Al Hudaydah', 'Ibb'],
                'Thailand': ['Bangkok', 'Chiang Mai', 'Phuket', 'Pattaya', 'Krabi'],
                'Singapore': ['Singapore'],
                'Malaysia': ['Kuala Lumpur', 'George Town', 'Johor Bahru', 'Malacca'],
                'Indonesia': ['Jakarta', 'Surabaya', 'Bandung', 'Medan', 'Semarang'],
                'Philippines': ['Manila', 'Cebu City', 'Davao', 'Quezon City'],
                'Vietnam': ['Hanoi', 'Ho Chi Minh City', 'Da Nang', 'Hue', 'Nha Trang'],
                'Myanmar': ['Yangon', 'Mandalay', 'Naypyidaw', 'Mawlamyine', 'Bago'],
                'Cambodia': ['Phnom Penh', 'Siem Reap', 'Battambang', 'Sihanoukville', 'Poipet'],
                'Laos': ['Vientiane', 'Luang Prabang', 'Savannakhet', 'Pakse', 'Thakhek']
            },
            'Europe': {
                'Russia': ['Moscow', 'St. Petersburg', 'Novosibirsk', 'Yekaterinburg', 'Kazan'],
                'Germany': ['Berlin', 'Munich', 'Hamburg', 'Cologne', 'Frankfurt', 'Stuttgart'],
                'France': ['Paris', 'Lyon', 'Marseille', 'Toulouse', 'Nice', 'Nantes'],
                'United Kingdom': ['London', 'Manchester', 'Birmingham', 'Glasgow', 'Liverpool'],
                'Italy': ['Rome', 'Milan', 'Naples', 'Turin', 'Florence', 'Venice'],
                'Spain': ['Madrid', 'Barcelona', 'Valencia', 'Seville', 'Bilbao'],
                'Netherlands': ['Amsterdam', 'Rotterdam', 'The Hague', 'Utrecht'],
                'Belgium': ['Brussels', 'Antwerp', 'Ghent', 'Bruges'],
                'Switzerland': ['Zurich', 'Geneva', 'Basel', 'Bern'],
                'Austria': ['Vienna', 'Salzburg', 'Innsbruck', 'Graz'],
                'Poland': ['Warsaw', 'Krakow', 'Gdansk', 'Wroclaw'],
                'Czech Republic': ['Prague', 'Brno', 'Ostrava'],
                'Hungary': ['Budapest', 'Debrecen', 'Szeged'],
                'Sweden': ['Stockholm', 'Gothenburg', 'Malmo'],
                'Norway': ['Oslo', 'Bergen', 'Trondheim'],
                'Denmark': ['Copenhagen', 'Aarhus', 'Odense'],
                'Finland': ['Helsinki', 'Tampere', 'Turku'],
                'Ukraine': ['Kyiv', 'Kharkiv', 'Odesa', 'Dnipro', 'Donetsk'],
                'Belarus': ['Minsk', 'Gomel', 'Mogilev', 'Vitebsk', 'Grodno'],
                'Romania': ['Bucharest', 'Cluj-Napoca', 'Timi»ôoara', 'Ia»ôi', 'Constan»õa'],
                'Bulgaria': ['Sofia', 'Plovdiv', 'Varna', 'Burgas', 'Ruse'],
                'Serbia': ['Belgrade', 'Novi Sad', 'Ni≈°', 'Kragujevac', 'Subotica'],
                'Croatia': ['Zagreb', 'Split', 'Rijeka', 'Osijek', 'Zadar'],
                'Bosnia and Herzegovina': ['Sarajevo', 'Banja Luka', 'Tuzla', 'Zenica', 'Mostar'],
                'Slovenia': ['Ljubljana', 'Maribor', 'Celje', 'Kranj', 'Velenje'],
                'Slovakia': ['Bratislava', 'Ko≈°ice', 'Pre≈°ov', '≈Ωilina', 'Bansk√° Bystrica'],
                'Lithuania': ['Vilnius', 'Kaunas', 'Klaipƒóda', '≈†iauliai', 'Panevƒó≈æys'],
                'Latvia': ['Riga', 'Daugavpils', 'LiepƒÅja', 'Jelgava', 'J≈´rmala'],
                'Estonia': ['Tallinn', 'Tartu', 'Narva', 'P√§rnu', 'Kohtla-J√§rve'],
                'Moldova': ['Chi»ôinƒÉu', 'Tiraspol', 'BƒÉl»õi', 'Bender', 'R√Æbni»õa'],
                'North Macedonia': ['Skopje', 'Bitola', 'Kumanovo', 'Prilep', 'Tetovo'],
                'Albania': ['Tirana', 'Durr√´s', 'Vlor√´', 'Elbasan', 'Shkod√´r'],
                'Montenegro': ['Podgorica', 'Nik≈°iƒá', 'Pljevlja', 'Bijelo Polje', 'Cetinje'],
                'Kosovo': ['Pristina', 'Prizren', 'Ferizaj', 'Peja', 'Gjakova'],
                'Greece': ['Athens', 'Thessaloniki', 'Patras', 'Heraklion', 'Larissa'],
                'Portugal': ['Lisbon', 'Porto', 'Vila Nova de Gaia', 'Amadora', 'Braga'],
                'Ireland': ['Dublin', 'Cork', 'Limerick', 'Galway', 'Waterford'],
                'Iceland': ['Reykjavik', 'K√≥pavogur', 'Hafnarfj√∂r√∞ur', 'Akureyri', 'Reykjanesb√¶r']
            },
            'North America': {
                'United States': ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix', 'Philadelphia', 'San Antonio', 'San Diego', 'Dallas', 'San Jose', 'Austin', 'Jacksonville', 'Fort Worth', 'Columbus', 'Charlotte', 'San Francisco', 'Indianapolis', 'Seattle', 'Denver', 'Washington DC', 'Boston', 'Nashville', 'Baltimore', 'Oklahoma City', 'Louisville', 'Portland', 'Las Vegas', 'Milwaukee', 'Albuquerque', 'Tucson', 'Fresno', 'Sacramento', 'Kansas City', 'Mesa', 'Atlanta', 'Omaha', 'Colorado Springs', 'Raleigh', 'Miami', 'Long Beach', 'Virginia Beach', 'Oakland', 'Minneapolis', 'Tampa', 'Tulsa', 'Arlington', 'New Orleans', 'Wichita', 'Cleveland', 'Bakersfield', 'Aurora', 'Anaheim', 'Honolulu', 'Santa Ana', 'Corpus Christi', 'Riverside', 'Lexington', 'Stockton', 'Henderson', 'Saint Paul', 'St. Louis', 'Cincinnati', 'Pittsburgh', 'Greensboro', 'Anchorage', 'Plano', 'Lincoln', 'Orlando', 'Irvine', 'Newark', 'Durham', 'Chula Vista', 'Toledo', 'Fort Wayne', 'St. Petersburg', 'Laredo', 'Jersey City', 'Chandler', 'Madison', 'Lubbock', 'Scottsdale', 'Reno', 'Buffalo', 'Gilbert', 'Glendale', 'North Las Vegas', 'Winston-Salem', 'Chesapeake', 'Norfolk', 'Fremont', 'Garland', 'Irving', 'Hialeah', 'Richmond', 'Boise', 'Spokane', 'Baton Rouge'],
                'Canada': ['Toronto', 'Montreal', 'Vancouver', 'Calgary', 'Edmonton', 'Ottawa', 'Winnipeg', 'Quebec City', 'Hamilton', 'Kitchener', 'London', 'Victoria', 'Halifax', 'Oshawa', 'Windsor', 'Saskatoon', 'St. Catharines', 'Regina', 'Sherbrooke', 'Barrie', 'Kelowna', 'Abbotsford', 'Kingston', 'Sudbury', 'Saguenay', 'Trois-Rivi√®res', 'Guelph', 'Cambridge', 'Whitby', 'Coquitlam', 'Saanich', 'Burlington', 'Richmond', 'Oakville', 'Burnaby', 'Richmond Hill', 'Thunder Bay', 'Vaughan', 'Mississauga', 'Laval', 'Brampton', 'Markham', 'Gatineau', 'Longueuil', 'Burnaby', 'Saskatoon', 'Langley', 'L√©vis', 'Kamloops', 'Surrey', 'Halifax', 'St. John\'s', 'Moncton', 'Nanaimo', 'Chicoutimi', 'Red Deer', 'Lethbridge', 'Medicine Hat', 'Drummondville', 'Granby', 'Saint-Hyacinthe', 'Shawinigan', 'Joliette', 'Victoriaville', 'Timmins', 'Saint John', 'Dolbeau-Mistassini', 'Sept-√éles', 'Val-d\'Or', 'Corner Brook', 'Edmundston', 'Fredericton', 'Dieppe', 'Rivi√®re-du-Loup', 'Rimouski', 'Sorel-Tracy', 'New Glasgow', 'Charlottetown', 'Summerside', 'Bridgewater', 'Yarmouth', 'Kentville', 'Truro'],
                'Mexico': ['Mexico City', 'Guadalajara', 'Monterrey', 'Puebla', 'Tijuana', 'Le√≥n', 'Ju√°rez', 'Torre√≥n', 'Quer√©taro', 'San Luis Potos√≠', 'M√©rida', 'Mexicali', 'Aguascalientes', 'Cuernavaca', 'Saltillo', 'Hermosillo', 'Culiac√°n', 'Chihuahua', 'Morelia', 'Tampico', 'Xalapa', 'Reynosa', 'Tuxtla Guti√©rrez', 'Durango', 'Toluca', 'Matamoros', 'Veracruz', 'Ciudad Victoria', 'Villahermosa', 'Nuevo Laredo', 'Mazatl√°n', 'Irapuato', 'Tlalnepantla', 'Naucalpan', 'Canc√∫n', 'Acapulco', 'Tlaquepaque', 'Guadalupe', 'Zapopan', 'Nezahualc√≥yotl', 'Chimalhuac√°n', 'Nicol√°s Romero', 'Celaya', 'Pachuca', 'Salamanca', 'Uruapan', 'Los Mochis', 'Monclova', 'Piedras Negras', 'Coatzacoalcos', 'Orizaba', 'Oaxaca', 'Tepic', 'Ensenada', 'Campeche', 'La Paz', 'Puerto Vallarta', 'Tapachula', 'Minatitl√°n', 'Poza Rica', 'C√≥rdoba', 'Veracruz', 'Chetumal', 'Ciudad del Carmen']
            },
            'South America': {
                'Brazil': ['S√£o Paulo', 'Rio de Janeiro', 'Bras√≠lia', 'Salvador', 'Fortaleza', 'Belo Horizonte', 'Manaus', 'Curitiba', 'Recife', 'Goi√¢nia'],
                'Argentina': ['Buenos Aires', 'C√≥rdoba', 'Rosario', 'Mendoza', 'La Plata', 'Tucum√°n'],
                'Chile': ['Santiago', 'Valpara√≠so', 'Concepci√≥n', 'La Serena', 'Antofagasta'],
                'Colombia': ['Bogot√°', 'Medell√≠n', 'Cali', 'Barranquilla', 'Cartagena'],
                'Peru': ['Lima', 'Arequipa', 'Trujillo', 'Chiclayo', 'Piura'],
                'Venezuela': ['Caracas', 'Maracaibo', 'Valencia', 'Barquisimeto', 'Maracay'],
                'Ecuador': ['Quito', 'Guayaquil', 'Cuenca', 'Santo Domingo', 'Machala'],
                'Bolivia': ['La Paz', 'Santa Cruz', 'Cochabamba', 'Sucre', 'Oruro'],
                'Paraguay': ['Asunci√≥n', 'Ciudad del Este', 'San Lorenzo', 'Luque'],
                'Uruguay': ['Montevideo', 'Salto', 'Paysand√∫', 'Las Piedras']
            },
            'Africa': {
                'South Africa': ['Cape Town', 'Johannesburg', 'Durban', 'Pretoria', 'Port Elizabeth'],
                'Egypt': ['Cairo', 'Alexandria', 'Giza', 'Shubra El Kheima', 'Port Said'],
                'Nigeria': ['Lagos', 'Kano', 'Ibadan', 'Kaduna', 'Port Harcourt'],
                'Kenya': ['Nairobi', 'Mombasa', 'Kisumu', 'Nakuru', 'Eldoret'],
                'Morocco': ['Casablanca', 'Rabat', 'Fez', 'Marrakech', 'Agadir'],
                'Ghana': ['Accra', 'Kumasi', 'Tamale', 'Takoradi', 'Cape Coast'],
                'Ethiopia': ['Addis Ababa', 'Dire Dawa', 'Mekelle', 'Gondar', 'Awasa'],
                'Tanzania': ['Dar es Salaam', 'Mwanza', 'Arusha', 'Dodoma', 'Mbeya'],
                'Uganda': ['Kampala', 'Gulu', 'Lira', 'Mbarara', 'Jinja'],
                'Algeria': ['Algiers', 'Oran', 'Constantine', 'Annaba', 'Blida'],
                'Libya': ['Tripoli', 'Benghazi', 'Misrata', 'Tarhuna', 'Al Bayda'],
                'Tunisia': ['Tunis', 'Sfax', 'Sousse', 'Ettadhamen', 'Kairouan'],
                'Sudan': ['Khartoum', 'Omdurman', 'Khartoum North', 'Kassala', 'Obeid'],
                'Angola': ['Luanda', 'Huambo', 'Lobito', 'Benguela', 'Kuito'],
                'Mozambique': ['Maputo', 'Matola', 'Beira', 'Nampula', 'Chimoio'],
                'Madagascar': ['Antananarivo', 'Toamasina', 'Antsirabe', 'Fianarantsoa', 'Mahajanga'],
                'Cameroon': ['Yaound√©', 'Douala', 'Bamenda', 'Bafoussam', 'Garoua'],
                'Ivory Coast': ['Abidjan', 'Bouak√©', 'Daloa', 'Yamoussoukro', 'San-P√©dro'],
                'Niger': ['Niamey', 'Zinder', 'Maradi', 'Agadez', 'Tahoua'],
                'Burkina Faso': ['Ouagadougou', 'Bobo-Dioulasso', 'Koudougou', 'Banfora', 'Ouahigouya'],
                'Mali': ['Bamako', 'Sikasso', 'Mopti', 'Koutiala', 'S√©gou'],
                'Malawi': ['Lilongwe', 'Blantyre', 'Mzuzu', 'Zomba', 'Kasungu'],
                'Zambia': ['Lusaka', 'Kitwe', 'Ndola', 'Kabwe', 'Chingola'],
                'Zimbabwe': ['Harare', 'Bulawayo', 'Chitungwiza', 'Mutare', 'Gweru'],
                'Botswana': ['Gaborone', 'Francistown', 'Molepolole', 'Maun', 'Serowe'],
                'Namibia': ['Windhoek', 'Rundu', 'Walvis Bay', 'Swakopmund', 'Oshakati'],
                'Senegal': ['Dakar', 'Touba', 'Thi√®s', 'Kaolack', 'Saint-Louis'],
                'Guinea': ['Conakry', 'Nz√©r√©kor√©', 'Kankan', 'Kindia', 'Labe'],
                'Rwanda': ['Kigali', 'Butare', 'Gitarama', 'Ruhengeri', 'Gisenyi'],
                'Benin': ['Cotonou', 'Abomey-Calavi', 'Djougou', 'Porto-Novo', 'Parakou'],
                'Togo': ['Lom√©', 'Sokod√©', 'Kara', 'Kpalim√©', 'Atakpam√©'],
                'Sierra Leone': ['Freetown', 'Bo', 'Kenema', 'Koidu', 'Makeni'],
                'Liberia': ['Monrovia', 'Gbarnga', 'Kakata', 'Bensonville', 'Harper'],
                'Central African Republic': ['Bangui', 'Bimbo', 'Berb√©rati', 'Carnot', 'Bambari'],
                'Chad': ['N\'Djamena', 'Moundou', 'Sarh', 'Ab√©ch√©', 'Kelo'],
                'Republic of the Congo': ['Brazzaville', 'Pointe-Noire', 'Dolisie', 'Nkayi', 'Mossendjo'],
                'Democratic Republic of the Congo': ['Kinshasa', 'Lubumbashi', 'Mbuji-Mayi', 'Kisangani', 'Masina'],
                'Gabon': ['Libreville', 'Port-Gentil', 'Franceville', 'Oyem', 'Moanda'],
                'Equatorial Guinea': ['Malabo', 'Bata', 'Ebebiyin', 'Aconibe', 'A√±isoc'],
                'Djibouti': ['Djibouti', 'Ali Sabieh', 'Dikhil', 'Tadjourah', 'Obock'],
                'Eritrea': ['Asmara', 'Keren', 'Massawa', 'Assab', 'Mendefera'],
                'Somalia': ['Mogadishu', 'Hargeisa', 'Bosaso', 'Kismayo', 'Merca'],
                'Mauritania': ['Nouakchott', 'Nouadhibou', 'N√©ma', 'Ka√©di', 'Rosso'],
                'Gambia': ['Banjul', 'Serekunda', 'Brikama', 'Bakau', 'Farafenni'],
                'Cape Verde': ['Praia', 'Mindelo', 'Santa Maria', 'Assomada', 'Porto Novo'],
                'S√£o Tom√© and Pr√≠ncipe': ['S√£o Tom√©', 'Santo Ant√≥nio', 'Neves', 'Santana', 'Guadalupe'],
                'Comoros': ['Moroni', 'Mutsamudu', 'Fomboni', 'Domoni', 'Sima'],
                'Mauritius': ['Port Louis', 'Beau Bassin-Rose Hill', 'Vacoas-Phoenix', 'Curepipe', 'Quatre Bornes'],
                'Seychelles': ['Victoria', 'Anse Boileau', 'Beau Vallon', 'Cascade', 'Anse Royale']
            },
            'Oceania': {
                'Australia': ['Sydney', 'Melbourne', 'Brisbane', 'Perth', 'Adelaide', 'Gold Coast', 'Newcastle', 'Canberra'],
                'New Zealand': ['Auckland', 'Wellington', 'Christchurch', 'Hamilton', 'Tauranga'],
                'Fiji': ['Suva', 'Nadi', 'Lautoka', 'Labasa'],
                'Papua New Guinea': ['Port Moresby', 'Lae', 'Mount Hagen', 'Madang']
            }
        };

        const carBrands = [
            'Toyota', 'Honda', 'Ford', 'Chevrolet', 'Nissan', 'Hyundai', 'Kia', 'Volkswagen', 
            'BMW', 'Mercedes-Benz', 'Audi', 'Lexus', 'Mazda', 'Subaru', 'Mitsubishi', 'Suzuki',
            'Jeep', 'Ram', 'GMC', 'Cadillac', 'Lincoln', 'Buick', 'Chrysler', 'Dodge',
            'Volvo', 'Jaguar', 'Land Rover', 'Porsche', 'Ferrari', 'Lamborghini', 'Bentley',
            'Rolls-Royce', 'Maserati', 'Alfa Romeo', 'Fiat', 'Peugeot', 'Renault', 'Citro√´n',
            'Skoda', 'SEAT', 'Opel', 'Saab', 'Mini', 'Smart', 'Tesla', 'Rivian', 'Lucid'
        ];

        // Initialize system with default admin
        if (users.length === 0) {
            users.push({
                id: 1,
                username: 'admin',
                email: 'admin@system.mn',
                password: 'admin123',
                isAdmin: true,
                registeredDate: new Date().toISOString()
            });
            saveData();
        }

        // Initialize with sample data if no cars exist
        if (cars.length === 0) {
            // Add sample users first
            const sampleUsers = [
                {
                    id: 2,
                    username: 'b.batbayar',
                    email: 'batbayar@embassy.mn',
                    password: 'user123',
                    isAdmin: false,
                    registeredDate: '2023-01-15T08:30:00.000Z'
                },
                {
                    id: 3,
                    username: 'ts.tuvshin',
                    email: 'tuvshin@consulate.mn',
                    password: 'user123',
                    isAdmin: false,
                    registeredDate: '2023-02-20T10:15:00.000Z'
                },
                {
                    id: 4,
                    username: 'g.ganbaatar',
                    email: 'ganbaatar@embassy.mn',
                    password: 'user123',
                    isAdmin: false,
                    registeredDate: '2023-03-10T14:45:00.000Z'
                }
            ];

            users.push(...sampleUsers);

            // Add sample cars with realistic data
            const sampleCars = [
                {
                    id: 1001,
                    userId: 2,
                    region: 'Asia',
                    country: 'China',
                    city: 'Beijing',
                    organization: 'embassy',
                    brand: 'Toyota',
                    model: 'Camry',
                    plateNumber: 'MNG-001',
                    regNumber: 'REG-2019-001',
                    color: '–¶–∞–≥–∞–∞–Ω',
                    purchaseDate: '2019-03-15',
                    usage: 'state',
                    mileage: 85000,
                    ownerName: null,
                    initialValuation: 35000,
                    currentValuation: 8750, // 5 years old, fully depreciated
                    accumulatedDepreciation: 26250,
                    valuation: 8750,
                    photo: null,
                    registeredDate: '2023-01-15T09:00:00.000Z'
                },
                {
                    id: 1002,
                    userId: 2,
                    region: 'Asia',
                    country: 'China',
                    city: 'Beijing',
                    organization: 'embassy',
                    brand: 'Honda',
                    model: 'Accord',
                    plateNumber: 'MNG-002',
                    regNumber: 'REG-2021-002',
                    color: '–•–∞—Ä',
                    purchaseDate: '2021-06-20',
                    usage: 'state',
                    mileage: 45000,
                    ownerName: null,
                    initialValuation: 32000,
                    currentValuation: 16000, // 3 years old, 50% depreciated
                    accumulatedDepreciation: 16000,
                    valuation: 16000,
                    photo: null,
                    registeredDate: '2023-01-15T09:15:00.000Z'
                },
                {
                    id: 1003,
                    userId: 3,
                    region: 'Europe',
                    country: 'Germany',
                    city: 'Berlin',
                    organization: 'consulate-general',
                    brand: 'BMW',
                    model: 'X5',
                    plateNumber: 'MNG-003',
                    regNumber: 'REG-2022-003',
                    color: '–°–∞–∞—Ä–∞–ª –º–µ—Ç–∞–ª–ª–∏–∫',
                    purchaseDate: '2022-09-10',
                    usage: 'state',
                    mileage: 25000,
                    ownerName: null,
                    initialValuation: 65000,
                    currentValuation: 48750, // 2 years old, 25% depreciated
                    accumulatedDepreciation: 16250,
                    valuation: 48750,
                    photo: null,
                    registeredDate: '2023-02-20T11:00:00.000Z'
                },
                {
                    id: 1004,
                    userId: 3,
                    region: 'Europe',
                    country: 'France',
                    city: 'Paris',
                    organization: 'embassy',
                    brand: 'Mercedes-Benz',
                    model: 'E-Class',
                    plateNumber: 'MNG-004',
                    regNumber: 'REG-2020-004',
                    color: '–•–∞—Ä –º–µ—Ç–∞–ª–ª–∏–∫',
                    purchaseDate: '2020-01-25',
                    usage: 'state',
                    mileage: 72000,
                    ownerName: null,
                    initialValuation: 55000,
                    currentValuation: 13750, // 4 years old, 75% depreciated
                    accumulatedDepreciation: 41250,
                    valuation: 13750,
                    photo: null,
                    registeredDate: '2023-02-20T11:30:00.000Z'
                },
                {
                    id: 1005,
                    userId: 4,
                    region: 'North America',
                    country: 'United States',
                    city: 'Washington DC',
                    organization: 'embassy',
                    brand: 'Ford',
                    model: 'Explorer',
                    plateNumber: 'MNG-005',
                    regNumber: 'REG-2023-005',
                    color: '–¶—ç–Ω—Ö—ç—Ä',
                    purchaseDate: '2023-05-12',
                    usage: 'state',
                    mileage: 15000,
                    ownerName: null,
                    initialValuation: 42000,
                    currentValuation: 42000, // Less than 1 year old, no depreciation
                    accumulatedDepreciation: 0,
                    valuation: 42000,
                    photo: null,
                    registeredDate: '2023-05-15T08:20:00.000Z'
                },
                {
                    id: 1006,
                    userId: 4,
                    region: 'North America',
                    country: 'Canada',
                    city: 'Ottawa',
                    organization: 'consulate',
                    brand: 'Chevrolet',
                    model: 'Suburban',
                    plateNumber: 'MNG-006',
                    regNumber: 'REG-2018-006',
                    color: '–¶–∞–≥–∞–∞–Ω',
                    purchaseDate: '2018-11-08',
                    usage: 'state',
                    mileage: 95000,
                    ownerName: null,
                    initialValuation: 48000,
                    currentValuation: 0, // 5+ years old, fully depreciated
                    accumulatedDepreciation: 48000,
                    valuation: 0,
                    photo: null,
                    registeredDate: '2023-03-10T15:00:00.000Z'
                },
                {
                    id: 1007,
                    userId: 2,
                    region: 'Asia',
                    country: 'Japan',
                    city: 'Tokyo',
                    organization: 'embassy',
                    brand: 'Lexus',
                    model: 'RX',
                    plateNumber: 'MNG-007',
                    regNumber: 'REG-2021-007',
                    color: '–ú”©–Ω–≥”©–ª”©–≥',
                    purchaseDate: '2021-12-03',
                    usage: 'state',
                    mileage: 38000,
                    ownerName: null,
                    initialValuation: 58000,
                    currentValuation: 29000, // 2+ years old, 50% depreciated
                    accumulatedDepreciation: 29000,
                    valuation: 29000,
                    photo: null,
                    registeredDate: '2023-01-20T10:30:00.000Z'
                },
                {
                    id: 1008,
                    userId: 3,
                    region: 'Europe',
                    country: 'United Kingdom',
                    city: 'London',
                    organization: 'embassy',
                    brand: 'Jaguar',
                    model: 'XF',
                    plateNumber: 'MNG-008',
                    regNumber: 'REG-2019-008',
                    color: '–•”©—Ö',
                    purchaseDate: '2019-07-22',
                    usage: 'state',
                    mileage: 88000,
                    ownerName: null,
                    initialValuation: 52000,
                    currentValuation: 0, // 5+ years old, fully depreciated
                    accumulatedDepreciation: 52000,
                    valuation: 0,
                    photo: null,
                    registeredDate: '2023-02-25T14:15:00.000Z'
                },
                {
                    id: 1009,
                    userId: 4,
                    region: 'Asia',
                    country: 'South Korea',
                    city: 'Seoul',
                    organization: 'consulate-general',
                    brand: 'Hyundai',
                    model: 'Genesis',
                    plateNumber: 'MNG-009',
                    regNumber: 'REG-2022-009',
                    color: '–£–ª–∞–∞–Ω',
                    purchaseDate: '2022-04-18',
                    usage: 'state',
                    mileage: 32000,
                    ownerName: null,
                    initialValuation: 45000,
                    currentValuation: 33750, // 2+ years old, 25% depreciated
                    accumulatedDepreciation: 11250,
                    valuation: 33750,
                    photo: null,
                    registeredDate: '2023-03-15T09:45:00.000Z'
                },
                {
                    id: 1010,
                    userId: 2,
                    region: 'Europe',
                    country: 'Russia',
                    city: 'Moscow',
                    organization: 'embassy',
                    brand: 'Audi',
                    model: 'A6',
                    plateNumber: 'MNG-010',
                    regNumber: 'REG-2020-010',
                    color: '–•–∞—Ä',
                    purchaseDate: '2020-08-14',
                    usage: 'state',
                    mileage: 68000,
                    ownerName: null,
                    initialValuation: 49000,
                    currentValuation: 12250, // 4+ years old, 75% depreciated
                    accumulatedDepreciation: 36750,
                    valuation: 12250,
                    photo: null,
                    registeredDate: '2023-01-25T11:20:00.000Z'
                },
                {
                    id: 1011,
                    userId: 3,
                    region: 'Asia',
                    country: 'India',
                    city: 'New Delhi',
                    organization: 'embassy',
                    brand: 'Toyota',
                    model: 'Fortuner',
                    plateNumber: 'MNG-011',
                    regNumber: 'REG-2023-011',
                    color: '–¶–∞–≥–∞–∞–Ω',
                    purchaseDate: '2023-08-05',
                    usage: 'state',
                    mileage: 8000,
                    ownerName: null,
                    initialValuation: 38000,
                    currentValuation: 38000, // Less than 1 year old, no depreciation
                    accumulatedDepreciation: 0,
                    valuation: 38000,
                    photo: null,
                    registeredDate: '2023-08-10T13:30:00.000Z'
                },
                {
                    id: 1012,
                    userId: 4,
                    region: 'Europe',
                    country: 'Italy',
                    city: 'Rome',
                    organization: 'consulate',
                    brand: 'Volkswagen',
                    model: 'Passat',
                    plateNumber: 'MNG-012',
                    regNumber: 'REG-2021-012',
                    color: '–°–∞–∞—Ä–∞–ª',
                    purchaseDate: '2021-10-30',
                    usage: 'state',
                    mileage: 52000,
                    ownerName: null,
                    initialValuation: 33000,
                    currentValuation: 16500, // 3+ years old, 50% depreciated
                    accumulatedDepreciation: 16500,
                    valuation: 16500,
                    photo: null,
                    registeredDate: '2023-03-20T16:00:00.000Z'
                },
                {
                    id: 1013,
                    userId: 2,
                    region: 'Asia',
                    country: 'Thailand',
                    city: 'Bangkok',
                    organization: 'consulate-general',
                    brand: 'Nissan',
                    model: 'Patrol',
                    plateNumber: 'MNG-013',
                    regNumber: 'REG-2019-013',
                    color: '–•“Ø—Ä—ç–Ω',
                    purchaseDate: '2019-12-12',
                    usage: 'state',
                    mileage: 78000,
                    ownerName: null,
                    initialValuation: 44000,
                    currentValuation: 0, // 5+ years old, fully depreciated
                    accumulatedDepreciation: 44000,
                    valuation: 0,
                    photo: null,
                    registeredDate: '2023-01-30T12:45:00.000Z'
                },
                {
                    id: 1014,
                    userId: 3,
                    region: 'North America',
                    country: 'United States',
                    city: 'New York',
                    organization: 'consulate-general',
                    brand: 'Cadillac',
                    model: 'Escalade',
                    plateNumber: 'MNG-014',
                    regNumber: 'REG-2022-014',
                    color: '–•–∞—Ä –º–µ—Ç–∞–ª–ª–∏–∫',
                    purchaseDate: '2022-01-28',
                    usage: 'state',
                    mileage: 41000,
                    ownerName: null,
                    initialValuation: 72000,
                    currentValuation: 36000, // 2+ years old, 50% depreciated
                    accumulatedDepreciation: 36000,
                    valuation: 36000,
                    photo: null,
                    registeredDate: '2023-02-28T10:00:00.000Z'
                },
                {
                    id: 1015,
                    userId: 4,
                    region: 'Asia',
                    country: 'Singapore',
                    city: 'Singapore',
                    organization: 'other',
                    brand: 'Honda',
                    model: 'Civic',
                    plateNumber: 'MNG-015',
                    regNumber: 'REG-2023-015',
                    color: '–ù–æ–≥–æ–æ–Ω',
                    purchaseDate: '2023-11-15',
                    usage: 'individual',
                    mileage: null,
                    ownerName: '–î.–î–æ—Ä–∂',
                    initialValuation: null,
                    currentValuation: null,
                    accumulatedDepreciation: null,
                    valuation: 28000,
                    photo: null,
                    registeredDate: '2023-11-20T14:30:00.000Z'
                }
            ];

            cars.push(...sampleCars);

            // Add sample maintenance records
            const sampleMaintenance = [
                {
                    id: 2001,
                    carId: 1001,
                    userId: 2,
                    type: 'maintenance',
                    subcategory: 'routine',
                    damageStatus: null,
                    description: '–ñ–∏—Ä–∏–π–Ω —Ç–µ—Ö–Ω–∏–∫ “Ø–π–ª—á–∏–ª–≥—ç—ç - —Ç–æ—Å —Å–æ–ª–∏—Ö, —à“Ø“Ø–ª—Ç“Ø“Ø—Ä —Å–æ–ª–∏—Ö',
                    cost: 250,
                    date: '2023-06-15',
                    photo: null,
                    estimatedPrice: null,
                    additionalDescription: null,
                    additionalPhoto: null,
                    councilDocument: null,
                    councilDocumentName: null,
                    createdDate: '2023-06-15T10:30:00.000Z'
                },
                {
                    id: 2002,
                    carId: 1003,
                    userId: 3,
                    type: 'damage',
                    subcategory: 'body_damage',
                    damageStatus: 'usable',
                    description: '–£—Ä–¥ —Ç–∞–ª—ã–Ω –±–∞–º–ø–µ—Ä –¥–∞—Ö—å –∂–∏–∂–∏–≥ –∑—É—Ä–∞–∞—Å',
                    cost: 0,
                    date: '2023-08-22',
                    photo: null,
                    estimatedPrice: 800,
                    additionalDescription: null,
                    additionalPhoto: null,
                    councilDocument: null,
                    councilDocumentName: null,
                    createdDate: '2023-08-22T14:15:00.000Z'
                },
                {
                    id: 2003,
                    carId: 1005,
                    userId: 4,
                    type: 'maintenance',
                    subcategory: 'parts',
                    damageStatus: null,
                    description: '–¢–æ–æ—Ä–º–æ—Å–Ω—ã –¥–∏—Å–∫–∏–π–≥ —Å–æ–ª–∏—Ö',
                    cost: 450,
                    date: '2023-09-10',
                    photo: null,
                    estimatedPrice: null,
                    additionalDescription: null,
                    additionalPhoto: null,
                    councilDocument: null,
                    councilDocumentName: null,
                    createdDate: '2023-09-10T09:20:00.000Z'
                },
                {
                    id: 2004,
                    carId: 1007,
                    userId: 2,
                    type: 'maintenance',
                    subcategory: 'routine',
                    damageStatus: null,
                    description: '–£–ª–∏—Ä–ª—ã–Ω —Ç–µ—Ö–Ω–∏–∫ “Ø–π–ª—á–∏–ª–≥—ç—ç',
                    cost: 320,
                    date: '2023-10-05',
                    photo: null,
                    estimatedPrice: null,
                    additionalDescription: null,
                    additionalPhoto: null,
                    councilDocument: null,
                    councilDocumentName: null,
                    createdDate: '2023-10-05T11:45:00.000Z'
                },
                {
                    id: 2005,
                    carId: 1014,
                    userId: 3,
                    type: 'damage',
                    subcategory: 'parts_damage',
                    damageStatus: 'unusable',
                    description: '–•”©–¥”©–ª–≥“Ø“Ø—Ä–∏–π–Ω —Ç–æ–º —ç–≤–¥—Ä—ç–ª',
                    cost: 0,
                    date: '2023-11-12',
                    photo: null,
                    estimatedPrice: null,
                    additionalDescription: '–•”©–¥”©–ª–≥“Ø“Ø—Ä–∏–π–Ω –±–ª–æ–∫ –±“Ø—Ä—ç–Ω —Å–æ–ª–∏—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π. –ó–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª –º–∞—à–∏–Ω—ã “Ø–Ω—ç–ª–≥—ç—ç–Ω—ç—ç—Å –¥–∞–≤–∂ –±–∞–π–Ω–∞.',
                    additionalPhoto: null,
                    councilDocument: null,
                    councilDocumentName: 'council_meeting_2023_11_15.pdf',
                    createdDate: '2023-11-12T16:30:00.000Z'
                }
            ];

            maintenance.push(...sampleMaintenance);

            // Add sample logs
            const sampleLogs = [
                {
                    id: 3001,
                    userId: 2,
                    username: 'b.batbayar',
                    action: '–ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Å—ç–Ω',
                    details: 'Toyota Camry (MNG-001) –±“Ø—Ä—Ç–≥—ç–ª—ç—ç',
                    timestamp: '2023-01-15T09:00:00.000Z'
                },
                {
                    id: 3002,
                    userId: 3,
                    username: 'ts.tuvshin',
                    action: '–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª –Ω—ç–º—Å—ç–Ω',
                    details: 'BMW X5-–¥ –≥—ç–º—Ç—ç–ª –Ω—ç–º–ª—ç—ç',
                    timestamp: '2023-08-22T14:15:00.000Z'
                },
                {
                    id: 3003,
                    userId: 4,
                    username: 'g.ganbaatar',
                    action: '–ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Å—ç–Ω',
                    details: 'Ford Explorer (MNG-005) –±“Ø—Ä—Ç–≥—ç–ª—ç—ç',
                    timestamp: '2023-05-15T08:20:00.000Z'
                }
            ];

            userLogs.push(...sampleLogs);

            // Add sample notifications
            const sampleNotifications = [
                {
                    id: 4001,
                    message: '–°–∏—Å—Ç–µ–º–¥ —à–∏–Ω—ç –º–∞—à–∏–Ω—É—É–¥ –Ω—ç–º—ç–≥–¥–ª—ç—ç',
                    type: 'info',
                    timestamp: new Date().toISOString(),
                    read: false
                },
                {
                    id: 4002,
                    message: '5 –º–∞—à–∏–Ω—ã –∞—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω –±–∞–π–Ω–∞',
                    type: 'warning',
                    timestamp: new Date().toISOString(),
                    read: false
                }
            ];

            notifications.push(...sampleNotifications);

            saveData();
        }

        // Dropdown functions
        function updateCountries() {
            const regionSelect = document.getElementById('carRegion');
            const countrySelect = document.getElementById('carCountry');
            const citySelect = document.getElementById('carCity');
            
            const selectedRegion = regionSelect.value;
            
            // Clear country and city dropdowns
            countrySelect.innerHTML = '<option value="">–£–ª—Å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            citySelect.innerHTML = '<option value="">–≠—Ö–ª—ç—ç–¥ —É–ª—Å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            
            if (selectedRegion && regionData[selectedRegion]) {
                const countries = Object.keys(regionData[selectedRegion]);
                countries.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    countrySelect.appendChild(option);
                });
            }
        }

        function updateCities() {
            const regionSelect = document.getElementById('carRegion');
            const countrySelect = document.getElementById('carCountry');
            const citySelect = document.getElementById('carCity');
            
            const selectedRegion = regionSelect.value;
            const selectedCountry = countrySelect.value;
            
            // Clear city dropdown
            citySelect.innerHTML = '<option value="">–•–æ—Ç —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            
            if (selectedRegion && selectedCountry && regionData[selectedRegion][selectedCountry]) {
                const cities = regionData[selectedRegion][selectedCountry];
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            }
        }

        function initializeCarBrands() {
            const brandSelect = document.getElementById('carBrand');
            brandSelect.innerHTML = '<option value="">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            
            carBrands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandSelect.appendChild(option);
            });
        }

        // Utility functions
        function saveData() {
            localStorage.setItem('carSystemUsers', JSON.stringify(users));
            localStorage.setItem('carSystemCars', JSON.stringify(cars));
            localStorage.setItem('carSystemMaintenance', JSON.stringify(maintenance));
            localStorage.setItem('carSystemLogs', JSON.stringify(userLogs));
            localStorage.setItem('carSystemNotifications', JSON.stringify(notifications));
        }

        function getCarAge(purchaseDate) {
            const purchase = new Date(purchaseDate);
            const now = new Date();
            return Math.floor((now - purchase) / (365.25 * 24 * 60 * 60 * 1000));
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function addLog(action, details) {
            userLogs.unshift({
                id: Date.now(),
                userId: currentUser.id,
                username: currentUser.username,
                action: action,
                details: details,
                timestamp: new Date().toISOString()
            });
            saveData();
        }

        function addNotification(message, type = 'info') {
            notifications.unshift({
                id: Date.now(),
                message: message,
                type: type,
                timestamp: new Date().toISOString(),
                read: false
            });
            saveData();
            updateNotificationBadge();
        }

        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            const adminBadge = document.getElementById('adminNotificationBadge');
            
            if (unreadCount > 0) {
                if (badge) {
                    badge.textContent = unreadCount;
                    badge.classList.remove('hidden');
                }
                if (adminBadge) {
                    adminBadge.textContent = unreadCount;
                    adminBadge.classList.remove('hidden');
                }
            } else {
                if (badge) badge.classList.add('hidden');
                if (adminBadge) adminBadge.classList.add('hidden');
            }
        }

        // Modal functions
        function showLogin() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function showRegister() {
            document.getElementById('registerModal').classList.remove('hidden');
        }

        function showForgotPassword() {
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('forgotPasswordModal').classList.remove('hidden');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function toggleAdminCode() {
            const checkbox = document.getElementById('isAdmin');
            const adminCodeSection = document.getElementById('adminCodeSection');
            
            if (checkbox.checked) {
                adminCodeSection.classList.remove('hidden');
            } else {
                adminCodeSection.classList.add('hidden');
            }
        }

        // Authentication functions
        function login(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                addLog('–ù—ç–≤—Ç—ç—Ä—Å—ç–Ω', `${username} —Å–∏—Å—Ç–µ–º–¥ –Ω—ç–≤—Ç—ç—Ä–ª—ç—ç`);
                
                if (user.isAdmin) {
                    showAdminPage();
                } else {
                    showUserPage();
                }
                
                closeModal('loginModal');
                showNotification('–ê–º–∂–∏–ª—Ç—Ç–∞–π –Ω—ç–≤—Ç—ç—Ä–ª—ç—ç!');
            } else {
                showNotification('–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä —ç—Å–≤—ç–ª –Ω—É—É—Ü “Ø–≥ –±—É—Ä—É—É!', 'error');
            }
        }

        function register(event) {
            event.preventDefault();
            
            const username = document.getElementById('regUsername').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const isAdmin = document.getElementById('isAdmin').checked;
            const adminCode = document.getElementById('adminCode').value;
            
            // Check if username already exists
            if (users.find(u => u.username === username)) {
                showNotification('–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä –∞–ª—å —Ö—ç–¥–∏–π–Ω –±“Ø—Ä—Ç–≥—ç–≥–¥—Å—ç–Ω –±–∞–π–Ω–∞!', 'error');
                return;
            }
            
            // Check admin code if admin privileges requested
            if (isAdmin && adminCode !== 'ADMIN2024') {
                showNotification('–ê–¥–º–∏–Ω –∫–æ–¥ –±—É—Ä—É—É –±–∞–π–Ω–∞!', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                username: username,
                email: email,
                password: password,
                isAdmin: isAdmin,
                registeredDate: new Date().toISOString()
            };
            
            users.push(newUser);
            saveData();
            
            addNotification(`–®–∏–Ω—ç —Ö—ç—Ä—ç–≥–ª—ç–≥—á –±“Ø—Ä—Ç–≥—ç–≥–¥–ª—ç—ç: ${username}`, 'info');
            addLog('–ë“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω', `${username} —à–∏–Ω—ç—ç—Ä –±“Ø—Ä—Ç–≥“Ø“Ø–ª–ª—ç—ç`);
            
            closeModal('registerModal');
            showNotification('–ê–º–∂–∏–ª—Ç—Ç–∞–π –±“Ø—Ä—Ç–≥—ç–ª—ç—ç!');
            setTimeout(() => {
                showLogin();
            }, 1500);
        }

        function forgotPassword(event) {
            event.preventDefault();
            
            const email = document.getElementById('forgotEmail').value;
            const user = users.find(u => u.email === email);
            
            if (user) {
                showNotification('–ù—É—É—Ü “Ø–≥ —Å—ç—Ä–≥—ç—ç—Ö –∑–∞–∞–≤–∞—Ä —Ç–∞–Ω—ã –∏-–º—ç–π–ª —Ö–∞—è–≥—Ç –∏–ª–≥—ç—ç–≥–¥–ª—ç—ç!');
                closeModal('forgotPasswordModal');
            } else {
                showNotification('–ò-–º—ç–π–ª —Ö–∞—è–≥ –æ–ª–¥—Å–æ–Ω–≥“Ø–π!', 'error');
            }
        }

        function logout() {
            addLog('–ì–∞—Ä—Å–∞–Ω', `${currentUser.username} —Å–∏—Å—Ç–µ–º—ç—ç—Å –≥–∞—Ä–ª–∞–∞`);
            currentUser = null;
            
            // Hide all pages
            document.getElementById('userPage').classList.add('hidden');
            document.getElementById('adminPage').classList.add('hidden');
            document.getElementById('welcomePage').classList.remove('hidden');
            
            showNotification('–ê–º–∂–∏–ª—Ç—Ç–∞–π –≥–∞—Ä–ª–∞–∞!');
        }

        // Page navigation functions
        function showUserPage() {
            document.getElementById('welcomePage').classList.add('hidden');
            document.getElementById('adminPage').classList.add('hidden');
            document.getElementById('userPage').classList.remove('hidden');
            
            document.getElementById('userWelcome').textContent = `–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É, ${currentUser.username}!`;
            
            showUserSection('carRegister');
            initializeCarBrands();
            loadUserCars();
            loadMaintenanceCarSelect();
            loadMaintenanceHistory();
            updateNotificationBadge();
        }

        function showAdminPage() {
            document.getElementById('welcomePage').classList.add('hidden');
            document.getElementById('userPage').classList.add('hidden');
            document.getElementById('adminPage').classList.remove('hidden');
            
            document.getElementById('adminWelcome').textContent = `–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É, ${currentUser.username}!`;
            
            showAdminSection('dashboard');
            updateNotificationBadge();
        }

        function showUserSection(section) {
            // Hide all user sections
            document.getElementById('carRegisterSection').classList.add('hidden');
            document.getElementById('maintenanceSection').classList.add('hidden');
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.user-nav-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-blue-500', 'text-blue-600');
        }

        function showAdminSection(section) {
            // Hide all admin sections
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('carsSection').classList.add('hidden');
            document.getElementById('adminMaintenanceSection').classList.add('hidden');
            document.getElementById('usersSection').classList.add('hidden');
            document.getElementById('valuationSection').classList.add('hidden');
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-blue-500', 'text-blue-600');
            
            // Load section data
            switch(section) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'cars':
                    loadAdminCars();
                    populateSearchFilters();
                    break;
                case 'adminMaintenance':
                    loadAdminMaintenance();
                    break;
                case 'users':
                    loadUsers();
                    loadUserLogs();
                    break;
                case 'valuation':
                    loadValuation();
                    break;
            }
        }

        // Car registration functions
        function toggleUsageFields() {
            const usage = document.getElementById('carUsage').value;
            const stateFields = document.getElementById('stateFields');
            const individualFields = document.getElementById('individualFields');
            const carMileage = document.getElementById('carMileage');
            const carInitialValuation = document.getElementById('carInitialValuation');
            const carPurchaseDate = document.getElementById('carPurchaseDate');
            const carPurchaseDateIndividual = document.getElementById('carPurchaseDateIndividual');
            const carOwnerName = document.getElementById('carOwnerName');
            
            if (usage === 'state') {
                stateFields.classList.remove('hidden');
                individualFields.classList.add('hidden');
                carMileage.required = true;
                carInitialValuation.required = true;
                carPurchaseDate.required = true;
                carPurchaseDateIndividual.required = false;
                carOwnerName.required = false;
            } else if (usage === 'individual') {
                stateFields.classList.add('hidden');
                individualFields.classList.remove('hidden');
                carMileage.required = false;
                carInitialValuation.required = false;
                carPurchaseDate.required = false;
                carPurchaseDateIndividual.required = true;
                carOwnerName.required = true;
            } else {
                stateFields.classList.add('hidden');
                individualFields.classList.add('hidden');
                carMileage.required = false;
                carInitialValuation.required = false;
                carPurchaseDate.required = false;
                carPurchaseDateIndividual.required = false;
                carOwnerName.required = false;
            }
            
            // Reset calculated fields when usage changes
            document.getElementById('calculatedFields').classList.add('hidden');
        }

        function calculateCurrentValuation() {
            const initialValuation = parseFloat(document.getElementById('carInitialValuation').value);
            const purchaseDate = document.getElementById('carPurchaseDate').value;
            
            if (!initialValuation || !purchaseDate) {
                document.getElementById('calculatedFields').classList.add('hidden');
                return;
            }
            
            const purchase = new Date(purchaseDate);
            const now = new Date();
            const yearsElapsed = Math.floor((now - purchase) / (365.25 * 24 * 60 * 60 * 1000));
            
            // Calculate depreciation: 25% per year for 4 years, then 0
            let depreciationRate = Math.min(yearsElapsed * 0.25, 1.0); // Max 100% depreciation
            let currentValuation = Math.max(initialValuation * (1 - depreciationRate), 0);
            let accumulatedDepreciation = initialValuation - currentValuation;
            
            // Update the fields
            document.getElementById('carCurrentValuation').value = Math.round(currentValuation);
            document.getElementById('carAccumulatedDepreciation').value = Math.round(accumulatedDepreciation);
            
            // Update depreciation info
            const depreciationInfo = document.getElementById('depreciationInfo');
            let statusText, statusColor, bgColor;
            
            if (yearsElapsed >= 4) {
                statusText = '–ë“Ø—Ä—ç–Ω —ç–ª—ç–≥–¥—Å—ç–Ω';
                statusColor = 'text-red-700';
                bgColor = 'bg-red-100 border border-red-200';
            } else if (yearsElapsed > 0) {
                statusText = '–≠–ª—ç–≥–¥—ç–∂ –±–∞–π–≥–∞–∞';
                statusColor = 'text-orange-700';
                bgColor = 'bg-orange-100 border border-orange-200';
            } else {
                statusText = '–®–∏–Ω—ç';
                statusColor = 'text-green-700';
                bgColor = 'bg-green-100 border border-green-200';
            }
            
            depreciationInfo.className = `text-sm p-3 rounded ${bgColor}`;
            depreciationInfo.innerHTML = `
                <div class="flex items-center justify-between">
                    <div>
                        <span class="font-medium ${statusColor}">–ú–∞—à–∏–Ω—ã –Ω–∞—Å:</span>
                        <span class="ml-2">${yearsElapsed} –∂–∏–ª</span>
                    </div>
                    <div class="text-right">
                        <div class="font-medium ${statusColor}">${statusText}</div>
                        <div class="text-sm">${Math.round(depreciationRate * 100)}% —ç–ª—ç–≥–¥—ç–ª</div>
                    </div>
                </div>
            `;
            
            // Show calculated fields
            document.getElementById('calculatedFields').classList.remove('hidden');
        }

        async function registerCar(event) {
            event.preventDefault();
            
            const usage = document.getElementById('carUsage').value;
            let purchaseDate, initialValuation = null, currentValuation = null, accumulatedDepreciation = null;
            
            if (usage === 'state') {
                purchaseDate = document.getElementById('carPurchaseDate').value;
                initialValuation = parseFloat(document.getElementById('carInitialValuation').value);
                currentValuation = parseFloat(document.getElementById('carCurrentValuation').value);
                accumulatedDepreciation = parseFloat(document.getElementById('carAccumulatedDepreciation').value);
            } else {
                purchaseDate = document.getElementById('carPurchaseDateIndividual').value;
            }
            
            const carData = {
                id: Date.now(),
                userId: currentUser.id,
                region: document.getElementById('carRegion').value,
                country: document.getElementById('carCountry').value,
                city: document.getElementById('carCity').value,
                organization: document.getElementById('carOrganization').value,
                brand: document.getElementById('carBrand').value,
                model: document.getElementById('carModel').value,
                plateNumber: document.getElementById('carPlateNumber').value,
                regNumber: document.getElementById('carRegNumber').value,
                color: document.getElementById('carColor').value,
                purchaseDate: purchaseDate,
                usage: usage,
                mileage: usage === 'state' ? document.getElementById('carMileage').value : null,
                ownerName: usage === 'individual' ? document.getElementById('carOwnerName').value : null,
                initialValuation: initialValuation,
                currentValuation: currentValuation,
                accumulatedDepreciation: accumulatedDepreciation,
                // Keep old valuation field for backward compatibility
                valuation: currentValuation || initialValuation,
                photo: document.getElementById('carPhoto').files[0] ? await convertToBase64(document.getElementById('carPhoto').files[0]) : null,
                registeredDate: new Date().toISOString()
            };
            
            cars.push(carData);
            saveData();
            
            addLog('–ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Å—ç–Ω', `${carData.brand} ${carData.model} (${carData.plateNumber}) –±“Ø—Ä—Ç–≥—ç–ª—ç—ç`);
            addNotification(`–®–∏–Ω—ç –º–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç–≥–¥–ª—ç—ç: ${carData.brand} ${carData.model}`, 'info');
            
            showNotification('–ú–∞—à–∏–Ω –∞–º–∂–∏–ª—Ç—Ç–∞–π –±“Ø—Ä—Ç–≥—ç–≥–¥–ª—ç—ç!');
            event.target.reset();
            toggleUsageFields(); // Reset field visibility
            loadUserCars();
            loadMaintenanceCarSelect();
        }

        function loadUserCars() {
            const userCars = cars.filter(car => car.userId === currentUser.id);
            const container = document.getElementById('userCarsList');
            
            if (userCars.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">–¢–∞ –æ–¥–æ–æ–≥–æ–æ—Ä –º–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—ç–≥“Ø–π –±–∞–π–Ω–∞.</p>';
                return;
            }
            
            container.innerHTML = userCars.map(car => {
                const carAge = getCarAge(car.purchaseDate);
                const isExpired = car.usage === 'state' && carAge > 5;
                
                return `
                <div class="border ${isExpired ? 'border-red-300 bg-red-50' : 'border-gray-200'} rounded-lg p-4">
                    ${isExpired ? `
                        <div class="mb-3 p-2 bg-red-100 border border-red-300 rounded-lg">
                            <div class="flex items-center">
                                <span class="text-red-600 mr-2">‚ö†Ô∏è</span>
                                <span class="text-red-700 font-medium text-sm">–ê—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω (${carAge} –∂–∏–ª)</span>
                            </div>
                        </div>
                    ` : ''}
                    <div class="flex gap-4">
                        <div class="flex-shrink-0">
                            ${car.photo ? 
                                `<img src="${car.photo}" alt="${car.brand} ${car.model}" class="w-24 h-18 object-cover rounded-lg border">` :
                                `<div class="w-24 h-18 bg-gray-200 rounded-lg border flex items-center justify-center">
                                    <span class="text-gray-400 text-xs">–ó—É—Ä–∞–≥ –±–∞–π—Ö–≥“Ø–π</span>
                                </div>`
                            }
                        </div>
                        <div class="flex-grow">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-semibold text-lg">${car.brand} ${car.model}</h3>
                                    <p class="text-gray-600">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä: ${car.plateNumber}</p>
                                    <p class="text-gray-600">”®–Ω–≥”©: ${car.color}</p>
                                    <p class="text-gray-600">–ë–∞–π—Ä—à–∏–ª: ${car.city}, ${car.country}</p>
                                    <p class="text-gray-600">–ê—à–∏–≥–ª–∞–ª—Ç: ${car.usage === 'state' ? '–¢”©—Ä–∏–π–Ω ”©–º—á' : '–•—É–≤–∏–π–Ω'}</p>
                                    ${car.usage === 'state' ? `<p class="text-gray-600">–ù–∞—Å: ${carAge} –∂–∏–ª</p>` : ''}
                                    ${car.initialValuation ? `
                                        <p class="text-gray-600">–ê–Ω—Ö–Ω—ã “Ø–Ω—ç–ª–≥—ç—ç: $${car.initialValuation.toLocaleString()}</p>
                                        <p class="text-green-600 font-medium">–û–¥–æ–æ–≥–∏–π–Ω “Ø–Ω—ç–ª–≥—ç—ç: $${(car.currentValuation || 0).toLocaleString()}</p>
                                        ${car.accumulatedDepreciation ? `<p class="text-red-600">–•—É—Ä–∏–º—Ç–ª–∞–≥–¥—Å–∞–Ω —ç–ª—ç–≥–¥—ç–ª: $${car.accumulatedDepreciation.toLocaleString()}</p>` : ''}
                                    ` : car.valuation ? `<p class="text-gray-600">“Æ–Ω—ç–ª–≥—ç—ç: $${car.valuation.toLocaleString()}</p>` : ''}
                                    ${car.mileage ? `<p class="text-gray-600">–ì“Ø–π–ª—Ç: ${car.mileage} –∫–º</p>` : ''}
                                    ${car.ownerName ? `<p class="text-gray-600">–≠–∑—ç–º—à–∏–≥—á: ${car.ownerName}</p>` : ''}
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="viewCarDetails(${car.id})" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                        –î—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π
                                    </button>
                                    <button onclick="editCar(${car.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                        –ó–∞—Å–∞—Ö
                                    </button>
                                    <button onclick="deleteCar(${car.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                        –£—Å—Ç–≥–∞—Ö
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        function editCar(carId) {
            const car = cars.find(c => c.id === carId);
            if (!car) return;
            
            // Fill form with car data
            document.getElementById('carRegion').value = car.region;
            document.getElementById('carCountry').value = car.country;
            document.getElementById('carCity').value = car.city;
            document.getElementById('carOrganization').value = car.organization;
            document.getElementById('carBrand').value = car.brand;
            document.getElementById('carModel').value = car.model;
            document.getElementById('carPlateNumber').value = car.plateNumber;
            document.getElementById('carRegNumber').value = car.regNumber;
            document.getElementById('carColor').value = car.color;
            document.getElementById('carPurchaseDate').value = car.purchaseDate;
            document.getElementById('carUsage').value = car.usage;
            document.getElementById('carValuation').value = car.valuation;
            
            if (car.usage === 'state') {
                document.getElementById('carMileage').value = car.mileage || '';
                toggleUsageFields();
            } else if (car.usage === 'individual') {
                document.getElementById('carOwnerName').value = car.ownerName || '';
                toggleUsageFields();
            }
            
            // Change form to edit mode
            const form = document.querySelector('#carRegisterSection form');
            form.onsubmit = function(event) {
                event.preventDefault();
                updateCar(carId);
            };
            
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.textContent = '–®–∏–Ω—ç—á–ª—ç—Ö';
            submitBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            submitBtn.classList.add('bg-green-600', 'hover:bg-green-700');
        }

        function updateCar(carId) {
            const carIndex = cars.findIndex(c => c.id === carId);
            if (carIndex === -1) return;
            
            cars[carIndex] = {
                ...cars[carIndex],
                region: document.getElementById('carRegion').value,
                country: document.getElementById('carCountry').value,
                city: document.getElementById('carCity').value,
                organization: document.getElementById('carOrganization').value,
                brand: document.getElementById('carBrand').value,
                model: document.getElementById('carModel').value,
                plateNumber: document.getElementById('carPlateNumber').value,
                regNumber: document.getElementById('carRegNumber').value,
                color: document.getElementById('carColor').value,
                purchaseDate: document.getElementById('carPurchaseDate').value,
                usage: document.getElementById('carUsage').value,
                mileage: document.getElementById('carMileage').value || null,
                ownerName: document.getElementById('carOwnerName').value || null,
                valuation: parseFloat(document.getElementById('carValuation').value)
            };
            
            saveData();
            addLog('–ú–∞—à–∏–Ω –∑–∞—Å–≤–∞—Ä–ª–∞—Å–∞–Ω', `${cars[carIndex].brand} ${cars[carIndex].model} –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —à–∏–Ω—ç—á–∏–ª–ª—ç—ç`);
            
            showNotification('–ú–∞—à–∏–Ω—ã –º—ç–¥—ç—ç–ª—ç–ª –∞–º–∂–∏–ª—Ç—Ç–∞–π —à–∏–Ω—ç—á–ª—ç–≥–¥–ª—ç—ç!');
            
            // Reset form
            const form = document.querySelector('#carRegisterSection form');
            form.reset();
            form.onsubmit = registerCar;
            
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.textContent = '–ú–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Ö';
            submitBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
            submitBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
            
            loadUserCars();
        }

        function deleteCar(carId) {
            if (!confirm('–¢–∞ —ç–Ω—ç –º–∞—à–∏–Ω—ã –±“Ø—Ä—Ç–≥—ç–ª–∏–π–≥ —É—Å—Ç–≥–∞—Ö–¥–∞–∞ –∏—Ç–≥—ç–ª—Ç—ç–π –±–∞–π–Ω–∞ —É—É?')) return;
            
            const carIndex = cars.findIndex(c => c.id === carId);
            if (carIndex === -1) return;
            
            const car = cars[carIndex];
            cars.splice(carIndex, 1);
            
            // Also delete related maintenance records
            maintenance = maintenance.filter(m => m.carId !== carId);
            
            saveData();
            addLog('–ú–∞—à–∏–Ω —É—Å—Ç–≥–∞—Å–∞–Ω', `${car.brand} ${car.model} (${car.plateNumber}) —É—Å—Ç–≥–∞–ª–∞–∞`);
            
            showNotification('–ú–∞—à–∏–Ω—ã –±“Ø—Ä—Ç–≥—ç–ª –∞–º–∂–∏–ª—Ç—Ç–∞–π —É—Å—Ç–≥–∞–≥–¥–ª–∞–∞!');
            loadUserCars();
            loadMaintenanceCarSelect();
        }

        // Maintenance functions
        function updateMaintenanceSubcategory() {
            const type = document.getElementById('maintenanceType').value;
            const subcategoryDiv = document.getElementById('maintenanceSubcategoryDiv');
            const subcategorySelect = document.getElementById('maintenanceSubcategory');
            const damageStatusDiv = document.getElementById('damageStatusDiv');
            const damageStatus = document.getElementById('damageStatus');
            
            // Clear previous options
            subcategorySelect.innerHTML = '<option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            
            // Hide all conditional fields
            document.getElementById('estimatedPriceDiv').classList.add('hidden');
            document.getElementById('unusableDetailsDiv').classList.add('hidden');
            
            if (type === 'maintenance') {
                subcategoryDiv.classList.remove('hidden');
                damageStatusDiv.classList.add('hidden');
                subcategorySelect.required = true;
                damageStatus.required = false;
                
                // Add maintenance subcategories
                const maintenanceOptions = [
                    { value: 'routine', text: '–£—Ä—Å–≥–∞–ª –∑–∞—Å–≤–∞—Ä, “Ø–π–ª—á–∏–ª–≥—ç—ç' },
                    { value: 'parts', text: '–≠–¥ –∞–Ω–≥–∏–π–Ω –∑–∞—Å–≤–∞—Ä' },
                    { value: 'other', text: '–ë—É—Å–∞–¥' }
                ];
                
                maintenanceOptions.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option.value;
                    optionElement.textContent = option.text;
                    subcategorySelect.appendChild(optionElement);
                });
                
            } else if (type === 'damage') {
                subcategoryDiv.classList.remove('hidden');
                damageStatusDiv.classList.remove('hidden');
                subcategorySelect.required = true;
                damageStatus.required = true;
                
                // Add damage subcategories
                const damageOptions = [
                    { value: 'parts_damage', text: '–≠–¥, –∞–Ω–≥–∏–π–Ω —ç–≤–¥—Ä—ç–ª, –≥—ç–º—Ç—ç–ª' },
                    { value: 'body_damage', text: '–ë—É–¥–∞–≥, –∏—Ö –±–∏–µ–∏–π–Ω —ç–≤–¥—Ä—ç–ª –≥—ç–º—Ç—ç–ª' },
                    { value: 'other', text: '–ë—É—Å–∞–¥' }
                ];
                
                damageOptions.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option.value;
                    optionElement.textContent = option.text;
                    subcategorySelect.appendChild(optionElement);
                });
                
            } else {
                subcategoryDiv.classList.add('hidden');
                damageStatusDiv.classList.add('hidden');
                subcategorySelect.required = false;
                damageStatus.required = false;
            }
        }

        function updateDamageStatusFields() {
            const damageStatus = document.getElementById('damageStatus').value;
            const estimatedPriceDiv = document.getElementById('estimatedPriceDiv');
            const unusableDetailsDiv = document.getElementById('unusableDetailsDiv');
            const estimatedPrice = document.getElementById('estimatedPrice');
            const additionalDescription = document.getElementById('additionalDescription');
            const additionalPhoto = document.getElementById('additionalPhoto');
            const councilDocument = document.getElementById('councilDocument');
            
            // Get main form fields
            const maintenanceCostDiv = document.querySelector('label[for="maintenanceCost"]').parentElement;
            const maintenanceDescriptionDiv = document.querySelector('label[for="maintenanceDescription"]').parentElement;
            const maintenancePhotoDiv = document.querySelector('label[for="maintenancePhoto"]').parentElement;
            const maintenanceDateDiv = document.querySelector('label[for="maintenanceDate"]').parentElement;
            const maintenanceCost = document.getElementById('maintenanceCost');
            const maintenanceDescription = document.getElementById('maintenanceDescription');
            const maintenancePhoto = document.getElementById('maintenancePhoto');
            const maintenanceDate = document.getElementById('maintenanceDate');
            
            if (damageStatus === 'usable') {
                // Show: estimated price, date, photo upload
                estimatedPriceDiv.classList.remove('hidden');
                maintenanceDateDiv.classList.remove('hidden');
                maintenancePhotoDiv.classList.remove('hidden');
                unusableDetailsDiv.classList.add('hidden');
                maintenanceCostDiv.classList.add('hidden');
                
                // Set required fields
                estimatedPrice.required = true;
                maintenanceDate.required = true;
                maintenancePhoto.required = true;
                additionalDescription.required = false;
                councilDocument.required = false;
                maintenanceCost.required = false;
                
            } else if (damageStatus === 'unusable') {
                // Show: additional description (required), file upload (required), hide cost
                unusableDetailsDiv.classList.remove('hidden');
                estimatedPriceDiv.classList.add('hidden');
                maintenanceCostDiv.classList.add('hidden');
                maintenanceDateDiv.classList.remove('hidden');
                maintenancePhotoDiv.classList.add('hidden');
                
                // Set required fields
                additionalDescription.required = true;
                councilDocument.required = true;
                maintenanceDate.required = true;
                estimatedPrice.required = false;
                maintenanceCost.required = false;
                maintenancePhoto.required = false;
                
            } else {
                // Default state - show all main fields
                estimatedPriceDiv.classList.add('hidden');
                unusableDetailsDiv.classList.add('hidden');
                maintenanceCostDiv.classList.remove('hidden');
                maintenanceDescriptionDiv.classList.remove('hidden');
                maintenancePhotoDiv.classList.remove('hidden');
                maintenanceDateDiv.classList.remove('hidden');
                
                // Set required fields
                estimatedPrice.required = false;
                additionalDescription.required = false;
                councilDocument.required = false;
                maintenanceCost.required = true;
                maintenanceDescription.required = true;
                maintenanceDate.required = true;
            }
        }

        function loadMaintenanceCarSelect() {
            const userCars = cars.filter(car => car.userId === currentUser.id);
            const select = document.getElementById('maintenanceCarSelect');
            
            select.innerHTML = '<option value="">–ú–∞—à–∏–Ω —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            userCars.forEach(car => {
                select.innerHTML += `<option value="${car.id}">${car.brand} ${car.model} (${car.plateNumber})</option>`;
            });
        }

        async function addMaintenance(event) {
            event.preventDefault();
            
            const maintenanceData = {
                id: Date.now(),
                carId: parseInt(document.getElementById('maintenanceCarSelect').value),
                userId: currentUser.id,
                type: document.getElementById('maintenanceType').value,
                subcategory: document.getElementById('maintenanceSubcategory').value,
                damageStatus: document.getElementById('damageStatus').value || null,
                description: document.getElementById('maintenanceDescription').value,
                cost: parseFloat(document.getElementById('maintenanceCost').value),
                date: document.getElementById('maintenanceDate').value,
                photo: document.getElementById('maintenancePhoto').files[0] ? await convertToBase64(document.getElementById('maintenancePhoto').files[0]) : null,
                estimatedPrice: document.getElementById('estimatedPrice').value ? parseFloat(document.getElementById('estimatedPrice').value) : null,
                additionalDescription: document.getElementById('additionalDescription').value || null,
                additionalPhoto: document.getElementById('additionalPhoto').files[0] ? await convertToBase64(document.getElementById('additionalPhoto').files[0]) : null,
                councilDocument: document.getElementById('councilDocument').files[0] ? await convertToBase64(document.getElementById('councilDocument').files[0]) : null,
                councilDocumentName: document.getElementById('councilDocument').files[0] ? document.getElementById('councilDocument').files[0].name : null,
                createdDate: new Date().toISOString()
            };
            
            maintenance.push(maintenanceData);
            saveData();
            
            const car = cars.find(c => c.id === maintenanceData.carId);
            const typeText = maintenanceData.type === 'maintenance' ? '–∑–∞—Å–≤–∞—Ä' : '–≥—ç–º—Ç—ç–ª';
            
            addLog('–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª –Ω—ç–º—Å—ç–Ω', `${car.brand} ${car.model}-–¥ ${typeText} –Ω—ç–º–ª—ç—ç`);
            addNotification(`${typeText} –º—ç–¥—ç—ç–ª—ç–ª –Ω—ç–º—ç–≥–¥–ª—ç—ç: ${car.brand} ${car.model}`, 'info');
            
            showNotification('–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª –∞–º–∂–∏–ª—Ç—Ç–∞–π –Ω—ç–º—ç–≥–¥–ª—ç—ç!');
            event.target.reset();
            updateMaintenanceSubcategory(); // Reset subcategory fields
            loadMaintenanceHistory();
        }

        function loadMaintenanceHistory() {
            const userCars = cars.filter(car => car.userId === currentUser.id);
            const userCarIds = userCars.map(car => car.id);
            const userMaintenance = maintenance.filter(m => userCarIds.includes(m.carId));
            
            const container = document.getElementById('maintenanceHistory');
            
            if (userMaintenance.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª –±–∞–π—Ö–≥“Ø–π.</p>';
                return;
            }
            
            container.innerHTML = userMaintenance.map(m => {
                const car = cars.find(c => c.id === m.carId);
                const typeText = m.type === 'maintenance' ? '–ó–∞—Å–≤–∞—Ä' : '–ì—ç–º—Ç—ç–ª';
                const typeColor = m.type === 'maintenance' ? 'bg-blue-100 text-blue-800' : 'bg-red-100 text-red-800';
                
                // Get subcategory text
                const subcategoryTexts = {
                    'routine': '–£—Ä—Å–≥–∞–ª –∑–∞—Å–≤–∞—Ä, “Ø–π–ª—á–∏–ª–≥—ç—ç',
                    'parts': '–≠–¥ –∞–Ω–≥–∏–π–Ω –∑–∞—Å–≤–∞—Ä',
                    'parts_damage': '–≠–¥, –∞–Ω–≥–∏–π–Ω —ç–≤–¥—Ä—ç–ª, –≥—ç–º—Ç—ç–ª',
                    'body_damage': '–ë—É–¥–∞–≥, –∏—Ö –±–∏–µ–∏–π–Ω —ç–≤–¥—Ä—ç–ª –≥—ç–º—Ç—ç–ª',
                    'other': '–ë—É—Å–∞–¥'
                };
                
                const subcategoryText = subcategoryTexts[m.subcategory] || m.subcategory;
                
                return `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex gap-4">
                            ${m.photo ? 
                                `<div class="flex-shrink-0">
                                    <img src="${m.photo}" alt="–ó–∞—Å–≤–∞—Ä/–ì—ç–º—Ç—ç–ª–∏–π–Ω –∑—É—Ä–∞–≥" class="w-24 h-18 object-cover rounded-lg border">
                                </div>` : ''
                            }
                            <div class="flex-grow">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <h4 class="font-semibold">${car ? car.brand + ' ' + car.model : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω –º–∞—à–∏–Ω'}</h4>
                                        <div class="flex gap-2 mt-1 flex-wrap">
                                            <span class="inline-block px-2 py-1 rounded-full text-xs font-medium ${typeColor}">${typeText}</span>
                                            <span class="inline-block px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">${subcategoryText}</span>
                                            ${m.damageStatus ? 
                                                `<span class="inline-block px-2 py-1 rounded-full text-xs font-medium ${m.damageStatus === 'usable' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                                    ${m.damageStatus === 'usable' ? '–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π' : '–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π'}
                                                </span>` : ''
                                            }
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-semibold text-green-600">$${m.cost.toLocaleString()}</p>
                                        ${m.estimatedPrice ? `<p class="text-sm text-blue-600">–¢–æ–æ—Ü–æ–æ–ª—Å–æ–Ω: $${m.estimatedPrice.toLocaleString()}</p>` : ''}
                                        <p class="text-sm text-gray-500">${new Date(m.date).toLocaleDateString('mn-MN')}</p>
                                    </div>
                                </div>
                                <p class="text-gray-700">${m.description}</p>
                                ${m.additionalDescription ? `<p class="text-gray-600 mt-2 text-sm"><strong>–ù—ç–º—ç–ª—Ç —Ç–∞–π–ª–±–∞—Ä:</strong> ${m.additionalDescription}</p>` : ''}
                                
                                ${m.additionalPhoto || m.councilDocument ? `
                                    <div class="mt-3 flex gap-4">
                                        ${m.additionalPhoto ? `
                                            <div>
                                                <p class="text-xs text-gray-500 mb-1">–ù—ç–º—ç–ª—Ç –∑—É—Ä–∞–≥:</p>
                                                <img src="${m.additionalPhoto}" alt="–ù—ç–º—ç–ª—Ç –∑—É—Ä–∞–≥" class="w-20 h-15 object-cover rounded border">
                                            </div>
                                        ` : ''}
                                        ${m.councilDocument ? `
                                            <div>
                                                <p class="text-xs text-gray-500 mb-1">–•—É—Ä–ª—ã–Ω —Ç—ç–º–¥—ç–≥–ª—ç–ª:</p>
                                                <div class="bg-blue-50 border border-blue-200 rounded px-2 py-1">
                                                    <span class="text-xs text-blue-700">üìÑ ${m.councilDocumentName || '–§–∞–π–ª'}</span>
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Admin functions

        function loadAdminCars() {
            const tbody = document.getElementById('adminCarsTable');
            
            tbody.innerHTML = cars.map(car => {
                const owner = users.find(u => u.id === car.userId);
                const carAge = getCarAge(car.purchaseDate);
                const isExpired = car.usage === 'state' && carAge > 5;
                
                return `
                    <tr class="${isExpired ? 'bg-red-50' : ''}">
                        <td class="px-6 py-4 whitespace-nowrap">
                            ${car.photo ? 
                                `<img src="${car.photo}" alt="${car.brand} ${car.model}" class="w-16 h-12 object-cover rounded-lg border">` :
                                `<div class="w-16 h-12 bg-gray-200 rounded-lg border flex items-center justify-center">
                                    <span class="text-gray-400 text-xs">–ó—É—Ä–∞–≥ –±–∞–π—Ö–≥“Ø–π</span>
                                </div>`
                            }
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                            ${car.plateNumber}
                            ${isExpired ? `
                                <div class="flex items-center mt-1">
                                    <span class="text-red-600 text-xs mr-1">‚ö†Ô∏è</span>
                                    <span class="text-red-600 text-xs font-medium">–ê—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω</span>
                                </div>
                            ` : ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${car.city}, ${car.country}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${getOrganizationText(car.organization)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${car.valuation ? '$' + car.valuation.toLocaleString() : '“Æ–Ω—ç–ª–≥—ç—ç –±–∞–π—Ö–≥“Ø–π'}
                            ${car.usage === 'state' ? `<div class="text-xs text-gray-400">${carAge} –∂–∏–ª</div>` : ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button onclick="adminEditCar(${car.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                    –ó–∞—Å–∞—Ö
                                </button>
                                <button onclick="adminDeleteCar(${car.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                    –£—Å—Ç–≥–∞—Ö
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Admin car form functions
        function toggleAdminCarForm() {
            const form = document.getElementById('adminCarForm');
            const btn = document.getElementById('toggleFormBtn');
            
            if (form.classList.contains('hidden')) {
                form.classList.remove('hidden');
                btn.textContent = '- –•–∞–∞—Ö';
                btn.classList.remove('bg-green-600', 'hover:bg-green-700');
                btn.classList.add('bg-red-600', 'hover:bg-red-700');
                loadAdminFormData();
            } else {
                form.classList.add('hidden');
                btn.textContent = '+ –ú–∞—à–∏–Ω –Ω—ç–º—ç—Ö';
                btn.classList.remove('bg-red-600', 'hover:bg-red-700');
                btn.classList.add('bg-green-600', 'hover:bg-green-700');
            }
        }

        function loadAdminFormData() {
            // Load users for admin car form
            const userSelect = document.getElementById('adminCarUser');
            userSelect.innerHTML = '<option value="">–•—ç—Ä—ç–≥–ª—ç–≥—á —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            users.forEach(user => {
                userSelect.innerHTML += `<option value="${user.id}">${user.username} (${user.email})</option>`;
            });
            
            // Load car brands for admin form
            const brandSelect = document.getElementById('adminCarBrand');
            brandSelect.innerHTML = '<option value="">–ú–∞—à–∏–Ω—ã –º–∞—Ä–∫ —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            carBrands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandSelect.appendChild(option);
            });
        }

        function updateAdminCountries() {
            const regionSelect = document.getElementById('adminCarRegion');
            const countrySelect = document.getElementById('adminCarCountry');
            const citySelect = document.getElementById('adminCarCity');
            
            const selectedRegion = regionSelect.value;
            
            countrySelect.innerHTML = '<option value="">–£–ª—Å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            citySelect.innerHTML = '<option value="">–≠—Ö–ª—ç—ç–¥ —É–ª—Å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            
            if (selectedRegion && regionData[selectedRegion]) {
                const countries = Object.keys(regionData[selectedRegion]);
                countries.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    countrySelect.appendChild(option);
                });
            }
        }

        function updateAdminCities() {
            const regionSelect = document.getElementById('adminCarRegion');
            const countrySelect = document.getElementById('adminCarCountry');
            const citySelect = document.getElementById('adminCarCity');
            
            const selectedRegion = regionSelect.value;
            const selectedCountry = countrySelect.value;
            
            citySelect.innerHTML = '<option value="">–•–æ—Ç —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>';
            
            if (selectedRegion && selectedCountry && regionData[selectedRegion][selectedCountry]) {
                const cities = regionData[selectedRegion][selectedCountry];
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            }
        }

        function toggleAdminUsageFields() {
            const usage = document.getElementById('adminCarUsage').value;
            const stateFields = document.getElementById('adminStateFields');
            const individualFields = document.getElementById('adminIndividualFields');
            const carMileage = document.getElementById('adminCarMileage');
            const carValuation = document.getElementById('adminCarValuation');
            
            if (usage === 'state') {
                stateFields.classList.remove('hidden');
                individualFields.classList.add('hidden');
                carMileage.required = true;
                carValuation.required = true;
            } else if (usage === 'individual') {
                stateFields.classList.add('hidden');
                individualFields.classList.remove('hidden');
                carMileage.required = false;
                carValuation.required = false;
            } else {
                stateFields.classList.add('hidden');
                individualFields.classList.add('hidden');
                carMileage.required = false;
                carValuation.required = false;
            }
        }

        async function adminRegisterCar(event) {
            event.preventDefault();
            
            const usage = document.getElementById('adminCarUsage').value;
            let valuation = null;
            
            if (usage === 'state') {
                valuation = parseFloat(document.getElementById('adminCarValuation').value);
            }
            
            const carData = {
                id: Date.now(),
                userId: parseInt(document.getElementById('adminCarUser').value),
                region: document.getElementById('adminCarRegion').value,
                country: document.getElementById('adminCarCountry').value,
                city: document.getElementById('adminCarCity').value,
                organization: document.getElementById('adminCarOrganization').value,
                brand: document.getElementById('adminCarBrand').value,
                model: document.getElementById('adminCarModel').value,
                plateNumber: document.getElementById('adminCarPlateNumber').value,
                regNumber: document.getElementById('adminCarRegNumber').value,
                color: document.getElementById('adminCarColor').value,
                purchaseDate: document.getElementById('adminCarPurchaseDate').value,
                usage: usage,
                mileage: usage === 'state' ? document.getElementById('adminCarMileage').value : null,
                ownerName: usage === 'individual' ? document.getElementById('adminCarOwnerName').value : null,
                valuation: valuation,
                photo: document.getElementById('adminCarPhoto').files[0] ? await convertToBase64(document.getElementById('adminCarPhoto').files[0]) : null,
                registeredDate: new Date().toISOString()
            };
            
            cars.push(carData);
            saveData();
            
            const user = users.find(u => u.id === carData.userId);
            addLog('–ê–¥–º–∏–Ω –º–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç—Å—ç–Ω', `–ê–¥–º–∏–Ω ${user.username}-–¥ ${carData.brand} ${carData.model} –±“Ø—Ä—Ç–≥—ç–ª—ç—ç`);
            addNotification(`–ê–¥–º–∏–Ω —à–∏–Ω—ç –º–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç–ª—ç—ç: ${carData.brand} ${carData.model}`, 'info');
            
            showNotification('–ú–∞—à–∏–Ω –∞–º–∂–∏–ª—Ç—Ç–∞–π –±“Ø—Ä—Ç–≥—ç–≥–¥–ª—ç—ç!');
            cancelAdminCarForm();
            loadAdminCars();
            populateSearchFilters();
        }

        function cancelAdminCarForm() {
            document.getElementById('adminCarForm').reset();
            document.getElementById('adminCarForm').classList.add('hidden');
            document.getElementById('adminPhotoPreview').classList.add('hidden');
            
            const btn = document.getElementById('toggleFormBtn');
            btn.textContent = '+ –ú–∞—à–∏–Ω –Ω—ç–º—ç—Ö';
            btn.classList.remove('bg-red-600', 'hover:bg-red-700');
            btn.classList.add('bg-green-600', 'hover:bg-green-700');
            
            toggleAdminUsageFields();
        }

        function previewAdminCarPhoto() {
            const fileInput = document.getElementById('adminCarPhoto');
            const preview = document.getElementById('adminPhotoPreview');
            const previewImage = document.getElementById('adminPreviewImage');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                preview.classList.add('hidden');
            }
        }

        // Advanced search functions
        function populateSearchFilters() {
            // Populate location filter
            const locationSelect = document.getElementById('searchLocation');
            const locations = [...new Set(cars.map(car => `${car.city}, ${car.country}`))];
            locationSelect.innerHTML = '<option value="">–ë“Ø—Ö –±–∞–π—Ä—à–∏–ª</option>';
            locations.forEach(location => {
                locationSelect.innerHTML += `<option value="${location}">${location}</option>`;
            });

            // Populate owner filter
            const ownerSelect = document.getElementById('searchOwner');
            const owners = [...new Set(cars.map(car => {
                const user = users.find(u => u.id === car.userId);
                return user ? user.username : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á';
            }))];
            ownerSelect.innerHTML = '<option value="">–ë“Ø—Ö —ç–∑—ç–º—à–∏–≥—á</option>';
            owners.forEach(owner => {
                ownerSelect.innerHTML += `<option value="${owner}">${owner}</option>`;
            });

            // Populate brand filter
            const brandSelect = document.getElementById('searchBrand');
            const brands = [...new Set(cars.map(car => car.brand))];
            brandSelect.innerHTML = '<option value="">–ë“Ø—Ö –º–∞—Ä–∫</option>';
            brands.forEach(brand => {
                brandSelect.innerHTML += `<option value="${brand}">${brand}</option>`;
            });
        }

        function performAdvancedSearch() {
            const plateNumber = document.getElementById('searchPlateNumber').value.toLowerCase();
            const location = document.getElementById('searchLocation').value;
            const organization = document.getElementById('searchOrganization').value;
            const owner = document.getElementById('searchOwner').value;
            const brand = document.getElementById('searchBrand').value;
            const usage = document.getElementById('searchUsage').value;
            const valuation = document.getElementById('searchValuation').value;

            let filteredCars = cars.filter(car => {
                // Plate number filter
                if (plateNumber && !car.plateNumber.toLowerCase().includes(plateNumber)) {
                    return false;
                }

                // Location filter
                if (location && `${car.city}, ${car.country}` !== location) {
                    return false;
                }

                // Organization filter
                if (organization && car.organization !== organization) {
                    return false;
                }

                // Owner filter
                if (owner) {
                    const user = users.find(u => u.id === car.userId);
                    const ownerName = user ? user.username : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á';
                    if (ownerName !== owner) {
                        return false;
                    }
                }

                // Brand filter
                if (brand && car.brand !== brand) {
                    return false;
                }

                // Usage filter
                if (usage && car.usage !== usage) {
                    return false;
                }

                // Valuation filter
                if (valuation && car.valuation) {
                    const val = car.valuation;
                    switch (valuation) {
                        case '0-10000':
                            if (val > 10000) return false;
                            break;
                        case '10000-25000':
                            if (val <= 10000 || val > 25000) return false;
                            break;
                        case '25000-50000':
                            if (val <= 25000 || val > 50000) return false;
                            break;
                        case '50000+':
                            if (val <= 50000) return false;
                            break;
                    }
                }

                // Expired filter
                const expired = document.getElementById('searchExpired').value;
                if (expired) {
                    const carAge = getCarAge(car.purchaseDate);
                    const isExpired = car.usage === 'state' && carAge > 5;
                    
                    if (expired === 'expired' && !isExpired) {
                        return false;
                    }
                    if (expired === 'active' && isExpired) {
                        return false;
                    }
                }

                return true;
            });

            displayFilteredCars(filteredCars);
        }

        function resetCarSearch() {
            document.getElementById('searchPlateNumber').value = '';
            document.getElementById('searchLocation').value = '';
            document.getElementById('searchOrganization').value = '';
            document.getElementById('searchOwner').value = '';
            document.getElementById('searchBrand').value = '';
            document.getElementById('searchUsage').value = '';
            document.getElementById('searchValuation').value = '';
            document.getElementById('searchExpired').value = '';
            
            loadAdminCars();
        }

        function displayFilteredCars(filteredCars) {
            const tbody = document.getElementById('adminCarsTable');
            
            tbody.innerHTML = filteredCars.map(car => {
                const owner = users.find(u => u.id === car.userId);
                const carAge = getCarAge(car.purchaseDate);
                const isExpired = car.usage === 'state' && carAge > 5;
                
                return `
                    <tr class="${isExpired ? 'bg-red-50' : ''}">
                        <td class="px-6 py-4 whitespace-nowrap">
                            ${car.photo ? 
                                `<img src="${car.photo}" alt="${car.brand} ${car.model}" class="w-16 h-12 object-cover rounded-lg border">` :
                                `<div class="w-16 h-12 bg-gray-200 rounded-lg border flex items-center justify-center">
                                    <span class="text-gray-400 text-xs">–ó—É—Ä–∞–≥ –±–∞–π—Ö–≥“Ø–π</span>
                                </div>`
                            }
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                            ${car.plateNumber}
                            ${isExpired ? `
                                <div class="flex items-center mt-1">
                                    <span class="text-red-600 text-xs mr-1">‚ö†Ô∏è</span>
                                    <span class="text-red-600 text-xs font-medium">–ê—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω</span>
                                </div>
                            ` : ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${car.city}, ${car.country}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${getOrganizationText(car.organization)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${car.valuation ? '$' + car.valuation.toLocaleString() : '“Æ–Ω—ç–ª–≥—ç—ç –±–∞–π—Ö–≥“Ø–π'}
                            ${car.usage === 'state' ? `<div class="text-xs text-gray-400">${carAge} –∂–∏–ª</div>` : ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button onclick="adminEditCar(${car.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                    –ó–∞—Å–∞—Ö
                                </button>
                                <button onclick="adminDeleteCar(${car.id})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                                    –£—Å—Ç–≥–∞—Ö
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function adminEditCar(carId) {
            // This would open an edit modal in a real system
            showNotification('–ó–∞—Å–∞—Ö —Ñ—É–Ω–∫—Ü —É–¥–∞—Ö–≥“Ø–π –Ω—ç–º—ç–≥–¥—ç–Ω—ç', 'info');
        }

        function adminDeleteCar(carId) {
            if (!confirm('–¢–∞ —ç–Ω—ç –º–∞—à–∏–Ω—ã –±“Ø—Ä—Ç–≥—ç–ª–∏–π–≥ —É—Å—Ç–≥–∞—Ö–¥–∞–∞ –∏—Ç–≥—ç–ª—Ç—ç–π –±–∞–π–Ω–∞ —É—É?')) return;
            
            const carIndex = cars.findIndex(c => c.id === carId);
            if (carIndex === -1) return;
            
            const car = cars[carIndex];
            cars.splice(carIndex, 1);
            maintenance = maintenance.filter(m => m.carId !== carId);
            
            saveData();
            addLog('–ê–¥–º–∏–Ω –º–∞—à–∏–Ω —É—Å—Ç–≥–∞—Å–∞–Ω', `–ê–¥–º–∏–Ω ${car.brand} ${car.model} —É—Å—Ç–≥–∞–ª–∞–∞`);
            
            showNotification('–ú–∞—à–∏–Ω—ã –±“Ø—Ä—Ç–≥—ç–ª —É—Å—Ç–≥–∞–≥–¥–ª–∞–∞!');
            loadAdminCars();
        }

        function loadAdminMaintenance() {
            const tbody = document.getElementById('adminMaintenanceTable');
            
            tbody.innerHTML = maintenance.map(m => {
                const car = cars.find(c => c.id === m.carId);
                const typeText = m.type === 'maintenance' ? '–ó–∞—Å–≤–∞—Ä' : '–ì—ç–º—Ç—ç–ª';
                
                return `
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${car ? car.brand + ' ' + car.model + ' (' + car.plateNumber + ')' : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω –º–∞—à–∏–Ω'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${typeText}</td>
                        <td class="px-6 py-4 text-sm text-gray-500">${m.description}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${m.cost.toLocaleString()}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(m.date).toLocaleDateString('mn-MN')}</td>
                    </tr>
                `;
            }).join('');
        }

        function loadUsers() {
            const tbody = document.getElementById('usersTable');
            
            tbody.innerHTML = users.map(user => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${user.username}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${user.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${user.isAdmin ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'}">
                            ${user.isAdmin ? '–ê–¥–º–∏–Ω' : '–•—ç—Ä—ç–≥–ª—ç–≥—á'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(user.registeredDate).toLocaleDateString('mn-MN')}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="toggleUserAdmin(${user.id})" class="text-blue-600 hover:text-blue-900 mr-2">
                            ${user.isAdmin ? '–ê–¥–º–∏–Ω —Ö–∞—Å–∞—Ö' : '–ê–¥–º–∏–Ω –±–æ–ª–≥–æ—Ö'}
                        </button>
                        <button onclick="deleteUser(${user.id})" class="text-red-600 hover:text-red-900">–£—Å—Ç–≥–∞—Ö</button>
                    </td>
                </tr>
            `).join('');
        }

        function toggleUserAdmin(userId) {
            const userIndex = users.findIndex(u => u.id === userId);
            if (userIndex === -1) return;
            
            users[userIndex].isAdmin = !users[userIndex].isAdmin;
            saveData();
            
            const action = users[userIndex].isAdmin ? '–ê–¥–º–∏–Ω —ç—Ä—Ö –æ–ª–≥–æ–ª–æ–æ' : '–ê–¥–º–∏–Ω —ç—Ä—Ö —Ö–∞—Å–ª–∞–∞';
            addLog('–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —ç—Ä—Ö ”©”©—Ä—á–∏–ª—Å”©–Ω', `${users[userIndex].username}-–¥ ${action}`);
            
            showNotification(`${users[userIndex].username}-–∏–π–Ω —ç—Ä—Ö –∞–º–∂–∏–ª—Ç—Ç–∞–π ”©”©—Ä—á–ª”©–≥–¥–ª”©”©!`);
            loadUsers();
        }

        function deleteUser(userId) {
            if (userId === currentUser.id) {
                showNotification('–¢–∞ ”©”©—Ä–∏–π–≥”©”© —É—Å—Ç–≥–∞–∂ –±–æ–ª–æ—Ö–≥“Ø–π!', 'error');
                return;
            }
            
            if (!confirm('–¢–∞ —ç–Ω—ç —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–≥ —É—Å—Ç–≥–∞—Ö–¥–∞–∞ –∏—Ç–≥—ç–ª—Ç—ç–π –±–∞–π–Ω–∞ —É—É?')) return;
            
            const userIndex = users.findIndex(u => u.id === userId);
            if (userIndex === -1) return;
            
            const user = users[userIndex];
            users.splice(userIndex, 1);
            
            // Also delete user's cars and maintenance records
            cars = cars.filter(c => c.userId !== userId);
            maintenance = maintenance.filter(m => m.userId !== userId);
            
            saveData();
            addLog('–•—ç—Ä—ç–≥–ª—ç–≥—á —É—Å—Ç–≥–∞—Å–∞–Ω', `${user.username} —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–≥ —É—Å—Ç–≥–∞–ª–∞–∞`);
            
            showNotification('–•—ç—Ä—ç–≥–ª—ç–≥—á –∞–º–∂–∏–ª—Ç—Ç–∞–π —É—Å—Ç–≥–∞–≥–¥–ª–∞–∞!');
            loadUsers();
        }

        function loadUserLogs() {
            const container = document.getElementById('userLogs');
            
            if (userLogs.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">“Æ–π–ª –∞–∂–∏–ª–ª–∞–≥–∞–∞–Ω—ã –ª–æ–≥ –±–∞–π—Ö–≥“Ø–π.</p>';
                return;
            }
            
            container.innerHTML = userLogs.slice(0, 50).map(log => `
                <div class="flex justify-between items-center py-2 px-4 bg-gray-50 rounded">
                    <div>
                        <span class="font-medium">${log.username}</span>
                        <span class="text-gray-600">- ${log.action}</span>
                        <span class="text-sm text-gray-500">${log.details}</span>
                    </div>
                    <span class="text-xs text-gray-400">${new Date(log.timestamp).toLocaleString('mn-MN')}</span>
                </div>
            `).join('');
        }

        function loadValuation() {
            const tbody = document.getElementById('valuationTable');
            
            tbody.innerHTML = cars.map(car => {
                const purchaseDate = new Date(car.purchaseDate);
                const now = new Date();
                const ageYears = Math.floor((now - purchaseDate) / (365.25 * 24 * 60 * 60 * 1000));
                const isOld = ageYears > 5;
                
                const carMaintenance = maintenance.filter(m => m.carId === car.id);
                const totalMaintenanceCost = carMaintenance.reduce((sum, m) => sum + m.cost, 0);
                
                return `
                    <tr class="${isOld ? 'bg-yellow-50' : ''}">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${car.brand} ${car.model} (${car.plateNumber})</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${car.valuation.toLocaleString()}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(car.purchaseDate).toLocaleDateString('mn-MN')}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <span class="${isOld ? 'text-red-600 font-medium' : 'text-green-600'}">${ageYears} –∂–∏–ª</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${totalMaintenanceCost.toLocaleString()}</td>
                    </tr>
                `;
            }).join('');
        }

        function filterValuation() {
            const filter = document.getElementById('valuationFilter').value;
            let filteredCars = cars;
            
            if (filter === 'old') {
                filteredCars = cars.filter(car => {
                    const ageYears = Math.floor((new Date() - new Date(car.purchaseDate)) / (365.25 * 24 * 60 * 60 * 1000));
                    return ageYears > 5;
                });
            } else if (filter === 'new') {
                filteredCars = cars.filter(car => {
                    const ageYears = Math.floor((new Date() - new Date(car.purchaseDate)) / (365.25 * 24 * 60 * 60 * 1000));
                    return ageYears <= 5;
                });
            }
            
            const tbody = document.getElementById('valuationTable');
            tbody.innerHTML = filteredCars.map(car => {
                const purchaseDate = new Date(car.purchaseDate);
                const now = new Date();
                const ageYears = Math.floor((now - purchaseDate) / (365.25 * 24 * 60 * 60 * 1000));
                const isOld = ageYears > 5;
                
                const carMaintenance = maintenance.filter(m => m.carId === car.id);
                const totalMaintenanceCost = carMaintenance.reduce((sum, m) => sum + m.cost, 0);
                
                return `
                    <tr class="${isOld ? 'bg-yellow-50' : ''}">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${car.brand} ${car.model} (${car.plateNumber})</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${car.valuation.toLocaleString()}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(car.purchaseDate).toLocaleDateString('mn-MN')}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <span class="${isOld ? 'text-red-600 font-medium' : 'text-green-600'}">${ageYears} –∂–∏–ª</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${totalMaintenanceCost.toLocaleString()}</td>
                    </tr>
                `;
            }).join('');
        }

        function searchValuation() {
            const searchTerm = document.getElementById('valuationSearchInput').value.toLowerCase();
            const filteredCars = cars.filter(car => 
                car.plateNumber.toLowerCase().includes(searchTerm) ||
                car.brand.toLowerCase().includes(searchTerm) ||
                car.model.toLowerCase().includes(searchTerm)
            );
            
            const tbody = document.getElementById('valuationTable');
            tbody.innerHTML = filteredCars.map(car => {
                const purchaseDate = new Date(car.purchaseDate);
                const now = new Date();
                const ageYears = Math.floor((now - purchaseDate) / (365.25 * 24 * 60 * 60 * 1000));
                const isOld = ageYears > 5;
                
                const carMaintenance = maintenance.filter(m => m.carId === car.id);
                const totalMaintenanceCost = carMaintenance.reduce((sum, m) => sum + m.cost, 0);
                
                return `
                    <tr class="${isOld ? 'bg-yellow-50' : ''}">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${car.brand} ${car.model} (${car.plateNumber})</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${car.valuation.toLocaleString()}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(car.purchaseDate).toLocaleDateString('mn-MN')}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <span class="${isOld ? 'text-red-600 font-medium' : 'text-green-600'}">${ageYears} –∂–∏–ª</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">$${totalMaintenanceCost.toLocaleString()}</td>
                    </tr>
                `;
            }).join('');
        }

        // Notification functions
        function toggleNotifications() {
            // Mark all notifications as read
            notifications.forEach(n => n.read = true);
            saveData();
            updateNotificationBadge();
            
            showNotification('–ë“Ø—Ö –º—ç–¥—ç–≥–¥—ç–ª —É–Ω—à–∏–≥–¥–ª–∞–∞');
        }

        function toggleAdminNotifications() {
            toggleNotifications();
        }

        // Photo helper functions
        function convertToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        function previewCarPhoto() {
            const fileInput = document.getElementById('carPhoto');
            const preview = document.getElementById('photoPreview');
            const previewImage = document.getElementById('previewImage');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                preview.classList.add('hidden');
            }
        }

        function previewMaintenancePhoto() {
            const fileInput = document.getElementById('maintenancePhoto');
            const preview = document.getElementById('maintenancePhotoPreview');
            const previewImage = document.getElementById('maintenancePreviewImage');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                preview.classList.add('hidden');
            }
        }

        function previewAdditionalPhoto() {
            const fileInput = document.getElementById('additionalPhoto');
            const preview = document.getElementById('additionalPhotoPreview');
            const previewImage = document.getElementById('additionalPreviewImage');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                preview.classList.add('hidden');
            }
        }

        function viewCarDetails(carId) {
            const car = cars.find(c => c.id === carId);
            if (!car) return;
            
            const carAge = getCarAge(car.purchaseDate);
            const isExpired = car.usage === 'state' && carAge > 5;
            
            const content = document.getElementById('carDetailsContent');
            content.innerHTML = `
                ${isExpired ? `
                    <div class="mb-4 p-3 bg-red-100 border border-red-300 rounded-lg">
                        <div class="flex items-center">
                            <span class="text-red-600 mr-2 text-lg">‚ö†Ô∏è</span>
                            <div>
                                <span class="text-red-700 font-medium">–ê—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω</span>
                                <p class="text-red-600 text-sm">–≠–Ω—ç –º–∞—à–∏–Ω ${carAge} –∂–∏–ª–∏–π–Ω –Ω–∞—Å—Ç–∞–π –±”©–≥”©”©–¥ —Ç”©—Ä–∏–π–Ω ”©–º—á–∏–π–Ω –º–∞—à–∏–Ω—ã 5 –∂–∏–ª–∏–π–Ω –∞—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ —Ö—ç—Ç—ç—Ä—Å—ç–Ω –±–∞–π–Ω–∞.</p>
                            </div>
                        </div>
                    </div>
                ` : ''}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        ${car.photo ? 
                            `<img src="${car.photo}" alt="${car.brand} ${car.model}" class="w-full h-64 object-cover rounded-lg border">` :
                            `<div class="w-full h-64 bg-gray-200 rounded-lg border flex items-center justify-center">
                                <span class="text-gray-400">–ó—É—Ä–∞–≥ –±–∞–π—Ö–≥“Ø–π</span>
                            </div>`
                        }
                    </div>
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800">${car.brand} ${car.model}</h3>
                            <p class="text-gray-600">${car.color} ”©–Ω–≥”©—Ç—ç–π</p>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="font-medium text-gray-700">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä:</span>
                                <p class="text-gray-600">${car.plateNumber}</p>
                            </div>
                            <div>
                                <span class="font-medium text-gray-700">–ê—Ä–ª—ã–Ω –¥—É–≥–∞–∞—Ä:</span>
                                <p class="text-gray-600">${car.regNumber}</p>
                            </div>
                            <div>
                                <span class="font-medium text-gray-700">–ë–∞–π—Ä—à–∏–ª:</span>
                                <p class="text-gray-600">${car.city}, ${car.country}</p>
                            </div>
                            <div>
                                <span class="font-medium text-gray-700">–ë“Ø—Å –Ω—É—Ç–∞–≥:</span>
                                <p class="text-gray-600">${car.region}</p>
                            </div>
                            <div>
                                <span class="font-medium text-gray-700">–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞:</span>
                                <p class="text-gray-600">${getOrganizationText(car.organization)}</p>
                            </div>
                            <div>
                                <span class="font-medium text-gray-700">–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω –æ–≥–Ω–æ–æ:</span>
                                <p class="text-gray-600">${new Date(car.purchaseDate).toLocaleDateString('mn-MN')}</p>
                            </div>
                        </div>
                        
                        <div class="border-t pt-4">
                            <span class="font-medium text-gray-700">–ê—à–∏–≥–ª–∞–ª—Ç:</span>
                            <p class="text-gray-600">${car.usage === 'state' ? '–¢”©—Ä–∏–π–Ω ”©–º—á' : '–•—É–≤–∏–π–Ω'}</p>
                            
                            ${car.usage === 'state' ? `
                                <div class="mt-2">
                                    <span class="font-medium text-gray-700">–ú–∞—à–∏–Ω—ã –Ω–∞—Å:</span>
                                    <p class="text-gray-600 ${isExpired ? 'text-red-600 font-medium' : ''}">${carAge} –∂–∏–ª</p>
                                </div>
                            ` : ''}
                            
                            ${car.valuation ? `
                                <div class="mt-2">
                                    <span class="font-medium text-gray-700">“Æ–Ω—ç–ª–≥—ç—ç:</span>
                                    <p class="text-green-600 font-semibold">$${car.valuation.toLocaleString()}</p>
                                </div>
                            ` : ''}
                            
                            ${car.mileage ? `
                                <div class="mt-2">
                                    <span class="font-medium text-gray-700">–ì“Ø–π–ª—Ç:</span>
                                    <p class="text-gray-600">${car.mileage} –∫–º</p>
                                </div>
                            ` : ''}
                            
                            ${car.ownerName ? `
                                <div class="mt-2">
                                    <span class="font-medium text-gray-700">–≠–∑—ç–º—à–∏–≥—á:</span>
                                    <p class="text-gray-600">${car.ownerName}</p>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="border-t pt-4">
                            <span class="font-medium text-gray-700">–ë“Ø—Ä—Ç–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ:</span>
                            <p class="text-gray-600">${new Date(car.registeredDate).toLocaleDateString('mn-MN')}</p>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('carDetailsModal').classList.remove('hidden');
        }

        function getOrganizationText(org) {
            const orgMap = {
                'embassy': '–≠–ª—á–∏–Ω —Å–∞–π–¥—ã–Ω —è–∞–º',
                'consulate-general': '–ï—Ä”©–Ω—Ö–∏–π –∫–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä',
                'consulate': '–ö–æ–Ω—Å—É–ª—ã–Ω –≥–∞–∑–∞—Ä',
                'other': '–ë—É—Å–∞–¥'
            };
            return orgMap[org] || org;
        }

        // Dashboard functions
        let distributionChart = null;
        let ageChart = null;
        let valuationChart = null;
        let currentChartView = 'region';

        function loadDashboard() {
            updateDashboardStats();
            loadRecentActivity();
            loadSystemAlerts();
            initializeCharts();
            initializeWorldMap();
        }

        function updateDashboardStats() {
            // Total cars
            document.getElementById('totalCars').textContent = cars.length;

            // Calculate real-time current valuation and total depreciation
            let totalCurrentValuation = 0;
            let totalDepreciation = 0;
            
            cars.forEach(car => {
                if (car.usage === 'state' && car.initialValuation) {
                    // Use new depreciation calculation for state cars
                    const carAge = getCarAge(car.purchaseDate);
                    const depreciationRate = Math.min(carAge * 0.25, 1.0);
                    const currentVal = Math.max(car.initialValuation * (1 - depreciationRate), 0);
                    const depreciation = car.initialValuation - currentVal;
                    
                    totalCurrentValuation += currentVal;
                    totalDepreciation += depreciation;
                } else if (car.valuation) {
                    // For individual cars or old format, use existing valuation
                    totalCurrentValuation += car.valuation;
                }
            });

            // Current total valuation
            document.getElementById('totalValuation').textContent = '$' + Math.round(totalCurrentValuation).toLocaleString();
            
            // Total depreciation
            document.getElementById('totalDepreciation').textContent = '$' + Math.round(totalDepreciation).toLocaleString();

            // Expired cars
            const expiredCount = cars.filter(car => {
                if (car.usage !== 'state') return false;
                const carAge = getCarAge(car.purchaseDate);
                return carAge > 5;
            }).length;
            document.getElementById('expiredCars').textContent = expiredCount;

            // Total maintenance cost (last month)
            const lastMonth = new Date();
            lastMonth.setMonth(lastMonth.getMonth() - 1);
            const recentMaintenanceCost = maintenance
                .filter(m => new Date(m.date) >= lastMonth)
                .reduce((sum, m) => sum + m.cost, 0);
            document.getElementById('totalMaintenanceCost').textContent = '$' + recentMaintenanceCost.toLocaleString();
        }

        function loadRecentActivity() {
            const container = document.getElementById('recentActivity');
            const recentLogs = userLogs.slice(0, 10);

            if (recentLogs.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">“Æ–π–ª –∞–∂–∏–ª–ª–∞–≥–∞–∞ –±–∞–π—Ö–≥“Ø–π.</p>';
                return;
            }

            container.innerHTML = recentLogs.map(log => {
                const timeAgo = getTimeAgo(new Date(log.timestamp));
                return `
                    <div class="flex items-start space-x-3 p-3 bg-gray-50 rounded-lg">
                        <div class="flex-shrink-0">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                <span class="text-blue-600 text-sm">üë§</span>
                            </div>
                        </div>
                        <div class="flex-grow min-w-0">
                            <p class="text-sm font-medium text-gray-900">${log.username}</p>
                            <p class="text-sm text-gray-600">${log.action} - ${log.details}</p>
                            <p class="text-xs text-gray-400 mt-1">${timeAgo}</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadSystemAlerts() {
            const container = document.getElementById('systemAlerts');
            const alerts = [];

            // Check for expired cars
            const expiredCars = cars.filter(car => {
                if (car.usage !== 'state') return false;
                const carAge = getCarAge(car.purchaseDate);
                return carAge > 5;
            });

            if (expiredCars.length > 0) {
                alerts.push({
                    type: 'warning',
                    title: '–•—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω –º–∞—à–∏–Ω—É—É–¥',
                    message: `${expiredCars.length} –º–∞—à–∏–Ω—ã –∞—à–∏–≥–ª–∞–ª—Ç—ã–Ω —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω –±–∞–π–Ω–∞.`,
                    action: '–î—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π —Ö–∞—Ä–∞—Ö',
                    onclick: 'showExpiredCars()'
                });
            }

            // Check for high maintenance costs
            const highMaintenanceCars = cars.filter(car => {
                const carMaintenance = maintenance.filter(m => m.carId === car.id);
                const totalCost = carMaintenance.reduce((sum, m) => sum + m.cost, 0);
                return totalCost > (car.valuation || 0) * 0.3; // More than 30% of car value
            });

            if (highMaintenanceCars.length > 0) {
                alerts.push({
                    type: 'info',
                    title: '”®–Ω–¥”©—Ä –∑–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª—Ç–∞–π –º–∞—à–∏–Ω—É—É–¥',
                    message: `${highMaintenanceCars.length} –º–∞—à–∏–Ω—ã –∑–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª ”©–Ω–¥”©—Ä –±–∞–π–Ω–∞.`,
                    action: '–®–∞–ª–≥–∞—Ö',
                    onclick: 'showHighMaintenanceCars()'
                });
            }

            // Check for recent registrations
            const recentCars = cars.filter(car => {
                const regDate = new Date(car.registeredDate);
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                return regDate >= weekAgo;
            });

            if (recentCars.length > 0) {
                alerts.push({
                    type: 'success',
                    title: '–®–∏–Ω—ç –±“Ø—Ä—Ç–≥—ç–ª“Ø“Ø–¥',
                    message: `–°“Ø“Ø–ª–∏–π–Ω 7 —Ö–æ–Ω–æ–≥—Ç ${recentCars.length} –º–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç–≥–¥–ª—ç—ç.`,
                    action: '–•–∞—Ä–∞—Ö',
                    onclick: 'showRecentCars()'
                });
            }

            if (alerts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">–ê–Ω—Ö–∞–∞—Ä—É—É–ª–≥–∞ –±–∞–π—Ö–≥“Ø–π.</p>';
                return;
            }

            container.innerHTML = alerts.map(alert => {
                const colorClasses = {
                    warning: 'bg-yellow-50 border-yellow-200 text-yellow-800',
                    info: 'bg-blue-50 border-blue-200 text-blue-800',
                    success: 'bg-green-50 border-green-200 text-green-800',
                    error: 'bg-red-50 border-red-200 text-red-800'
                };

                const iconMap = {
                    warning: '‚ö†Ô∏è',
                    info: '‚ÑπÔ∏è',
                    success: '‚úÖ',
                    error: '‚ùå'
                };

                return `
                    <div class="border rounded-lg p-4 ${colorClasses[alert.type]}">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <span class="text-lg">${iconMap[alert.type]}</span>
                            </div>
                            <div class="ml-3 flex-grow">
                                <h4 class="text-sm font-medium">${alert.title}</h4>
                                <p class="text-sm mt-1">${alert.message}</p>
                                ${alert.action ? `
                                    <button onclick="${alert.onclick}" class="mt-2 text-sm font-medium underline hover:no-underline">
                                        ${alert.action}
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function initializeCharts() {
            initializeDistributionChart();
            initializeAgeChart();
            initializeValuationChart();
        }

        function initializeDistributionChart() {
            const ctx = document.getElementById('distributionChart').getContext('2d');
            
            if (distributionChart) {
                distributionChart.destroy();
            }

            const data = getDistributionData(currentChartView);
            
            distributionChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: data.labels,
                    datasets: [{
                        data: data.values,
                        backgroundColor: [
                            '#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6',
                            '#06B6D4', '#84CC16', '#F97316', '#EC4899', '#6B7280'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
        }

        function initializeAgeChart() {
            const ctx = document.getElementById('ageChart').getContext('2d');
            
            if (ageChart) {
                ageChart.destroy();
            }

            const ageData = getAgeDistributionData();
            
            ageChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ageData.labels,
                    datasets: [{
                        label: '–ú–∞—à–∏–Ω—ã —Ç–æ–æ',
                        data: ageData.values,
                        backgroundColor: ageData.colors,
                        borderColor: ageData.colors.map(color => color.replace('0.8', '1')),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function initializeValuationChart() {
            const ctx = document.getElementById('valuationChart').getContext('2d');
            
            if (valuationChart) {
                valuationChart.destroy();
            }

            const valuationData = getValuationData();
            
            valuationChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['–û–¥–æ–æ–≥–∏–π–Ω “Ø–Ω—ç–ª–≥—ç—ç', '–•—É—Ä–∏–º—Ç–ª–∞–≥–¥—Å–∞–Ω —ç–ª—ç–≥–¥—ç–ª'],
                    datasets: [{
                        data: [valuationData.currentValue, valuationData.totalDepreciation],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.8)',   // Green for current value
                            'rgba(239, 68, 68, 0.8)'    // Red for depreciation
                        ],
                        borderColor: [
                            'rgba(34, 197, 94, 1)',
                            'rgba(239, 68, 68, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                generateLabels: function(chart) {
                                    const data = chart.data;
                                    return data.labels.map((label, i) => {
                                        const value = data.datasets[0].data[i];
                                        return {
                                            text: `${label}: $${Math.round(value).toLocaleString()}`,
                                            fillStyle: data.datasets[0].backgroundColor[i],
                                            strokeStyle: data.datasets[0].borderColor[i],
                                            pointStyle: 'circle'
                                        };
                                    });
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: $${Math.round(value).toLocaleString()} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function getDistributionData(viewType) {
            const data = {};
            
            if (viewType === 'region') {
                cars.forEach(car => {
                    data[car.region] = (data[car.region] || 0) + 1;
                });
            } else if (viewType === 'brand') {
                cars.forEach(car => {
                    data[car.brand] = (data[car.brand] || 0) + 1;
                });
            }

            return {
                labels: Object.keys(data),
                values: Object.values(data)
            };
        }

        function getAgeDistributionData() {
            const ageGroups = {
                '0-1 –∂–∏–ª': 0,
                '1-3 –∂–∏–ª': 0,
                '3-5 –∂–∏–ª': 0,
                '5-7 –∂–∏–ª': 0,
                '7+ –∂–∏–ª': 0
            };

            cars.forEach(car => {
                const age = getCarAge(car.purchaseDate);
                if (age <= 1) ageGroups['0-1 –∂–∏–ª']++;
                else if (age <= 3) ageGroups['1-3 –∂–∏–ª']++;
                else if (age <= 5) ageGroups['3-5 –∂–∏–ª']++;
                else if (age <= 7) ageGroups['5-7 –∂–∏–ª']++;
                else ageGroups['7+ –∂–∏–ª']++;
            });

            return {
                labels: Object.keys(ageGroups),
                values: Object.values(ageGroups),
                colors: [
                    'rgba(34, 197, 94, 0.8)',   // Green for new cars
                    'rgba(59, 130, 246, 0.8)',  // Blue for 1-3 years
                    'rgba(245, 158, 11, 0.8)',  // Yellow for 3-5 years
                    'rgba(239, 68, 68, 0.8)',   // Red for 5-7 years
                    'rgba(107, 114, 128, 0.8)'  // Gray for 7+ years
                ]
            };
        }

        function getValuationData() {
            let totalCurrentValuation = 0;
            let totalDepreciation = 0;
            
            cars.forEach(car => {
                if (car.usage === 'state' && car.initialValuation) {
                    // Use new depreciation calculation for state cars
                    const carAge = getCarAge(car.purchaseDate);
                    const depreciationRate = Math.min(carAge * 0.25, 1.0);
                    const currentVal = Math.max(car.initialValuation * (1 - depreciationRate), 0);
                    const depreciation = car.initialValuation - currentVal;
                    
                    totalCurrentValuation += currentVal;
                    totalDepreciation += depreciation;
                } else if (car.valuation) {
                    // For individual cars or old format, use existing valuation
                    totalCurrentValuation += car.valuation;
                }
            });

            return {
                currentValue: totalCurrentValuation,
                totalDepreciation: totalDepreciation
            };
        }

        function updateChartView(viewType) {
            currentChartView = viewType;
            
            // Update button styles
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.classList.remove('bg-blue-100', 'text-blue-700');
                btn.classList.add('bg-gray-100', 'text-gray-700');
            });
            
            event.target.classList.remove('bg-gray-100', 'text-gray-700');
            event.target.classList.add('bg-blue-100', 'text-blue-700');
            
            initializeDistributionChart();
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return '–°–∞—è—Ö–∞–Ω';
            if (diffInSeconds < 3600) return Math.floor(diffInSeconds / 60) + ' –º–∏–Ω—É—Ç—ã–Ω ”©–º–Ω”©';
            if (diffInSeconds < 86400) return Math.floor(diffInSeconds / 3600) + ' —Ü–∞–≥–∏–π–Ω ”©–º–Ω”©';
            if (diffInSeconds < 2592000) return Math.floor(diffInSeconds / 86400) + ' ”©–¥—Ä–∏–π–Ω ”©–º–Ω”©';
            return Math.floor(diffInSeconds / 2592000) + ' —Å–∞—Ä—ã–Ω ”©–º–Ω”©';
        }

        // World Map Functions
        function initializeWorldMap() {
            const mapContainer = document.getElementById('worldMap');
            const tooltip = document.getElementById('mapTooltip');
            
            // Get car counts by country
            const countryData = getCarCountsByCountry();
            
            // Create SVG world map
            const svgMap = createWorldMapSVG(countryData);
            mapContainer.innerHTML = svgMap;
            
            // Add event listeners to countries
            const countryElements = mapContainer.querySelectorAll('.country');
            countryElements.forEach(element => {
                const countryName = element.getAttribute('data-country');
                const carCount = countryData[countryName] || 0;
                
                if (carCount > 0) {
                    element.style.cursor = 'pointer';
                    
                    element.addEventListener('mouseenter', (e) => {
                        showMapTooltip(e, countryName, carCount, tooltip);
                    });
                    
                    element.addEventListener('mouseleave', () => {
                        hideMapTooltip(tooltip);
                    });
                    
                    element.addEventListener('mousemove', (e) => {
                        updateTooltipPosition(e, tooltip);
                    });
                    
                    element.addEventListener('click', () => {
                        showCountryDetails(countryName);
                    });
                }
            });
        }

        function getCarCountsByCountry() {
            const countryData = {};
            cars.forEach(car => {
                countryData[car.country] = (countryData[car.country] || 0) + 1;
            });
            return countryData;
        }

        function getCountryColor(carCount) {
            if (carCount === 0) return '#e5e7eb'; // Gray for no cars
            if (carCount <= 5) return '#10b981'; // Green for 1-5 cars
            if (carCount <= 10) return '#f59e0b'; // Yellow for 6-10 cars
            return '#ef4444'; // Red for 10+ cars
        }

        function createWorldMapSVG(countryData) {
            // Simplified world map with major countries where embassies/consulates are typically located
            const countries = [
                // Asia
                { name: 'China', path: 'M580 180 L620 180 L640 200 L640 240 L600 260 L560 240 L560 200 Z', coords: [600, 220] },
                { name: 'Japan', path: 'M650 200 L670 200 L670 240 L650 240 Z', coords: [660, 220] },
                { name: 'South Korea', path: 'M640 220 L650 220 L650 235 L640 235 Z', coords: [645, 227] },
                { name: 'India', path: 'M520 240 L560 240 L560 300 L520 300 Z', coords: [540, 270] },
                { name: 'Thailand', path: 'M560 280 L580 280 L580 320 L560 320 Z', coords: [570, 300] },
                { name: 'Singapore', path: 'M580 320 L590 320 L590 330 L580 330 Z', coords: [585, 325] },
                { name: 'Russia', path: 'M480 120 L680 120 L680 180 L480 180 Z', coords: [580, 150] },
                { name: 'Kazakhstan', path: 'M480 180 L540 180 L540 220 L480 220 Z', coords: [510, 200] },
                { name: 'Turkey', path: 'M420 200 L460 200 L460 220 L420 220 Z', coords: [440, 210] },
                { name: 'Iran', path: 'M460 220 L500 220 L500 260 L460 260 Z', coords: [480, 240] },
                { name: 'Saudi Arabia', path: 'M440 260 L480 260 L480 300 L440 300 Z', coords: [460, 280] },
                { name: 'UAE', path: 'M480 280 L500 280 L500 300 L480 300 Z', coords: [490, 290] },
                
                // Europe
                { name: 'Germany', path: 'M380 160 L400 160 L400 180 L380 180 Z', coords: [390, 170] },
                { name: 'France', path: 'M360 170 L380 170 L380 190 L360 190 Z', coords: [370, 180] },
                { name: 'United Kingdom', path: 'M340 150 L360 150 L360 170 L340 170 Z', coords: [350, 160] },
                { name: 'Italy', path: 'M380 190 L400 190 L400 220 L380 220 Z', coords: [390, 205] },
                { name: 'Spain', path: 'M340 190 L360 190 L360 210 L340 210 Z', coords: [350, 200] },
                { name: 'Netherlands', path: 'M370 150 L385 150 L385 165 L370 165 Z', coords: [377, 157] },
                { name: 'Belgium', path: 'M365 165 L380 165 L380 175 L365 175 Z', coords: [372, 170] },
                { name: 'Switzerland', path: 'M375 180 L390 180 L390 190 L375 190 Z', coords: [382, 185] },
                { name: 'Austria', path: 'M390 175 L410 175 L410 185 L390 185 Z', coords: [400, 180] },
                { name: 'Poland', path: 'M400 150 L420 150 L420 170 L400 170 Z', coords: [410, 160] },
                { name: 'Czech Republic', path: 'M395 170 L410 170 L410 180 L395 180 Z', coords: [402, 175] },
                { name: 'Hungary', path: 'M405 180 L420 180 L420 190 L405 190 Z', coords: [412, 185] },
                { name: 'Sweden', path: 'M390 120 L410 120 L410 150 L390 150 Z', coords: [400, 135] },
                { name: 'Norway', path: 'M380 110 L400 110 L400 140 L380 140 Z', coords: [390, 125] },
                { name: 'Denmark', path: 'M385 145 L400 145 L400 155 L385 155 Z', coords: [392, 150] },
                { name: 'Finland', path: 'M410 110 L430 110 L430 140 L410 140 Z', coords: [420, 125] },
                
                // North America
                { name: 'United States', path: 'M120 180 L280 180 L280 260 L120 260 Z', coords: [200, 220] },
                { name: 'Canada', path: 'M120 120 L280 120 L280 180 L120 180 Z', coords: [200, 150] },
                { name: 'Mexico', path: 'M140 260 L240 260 L240 320 L140 320 Z', coords: [190, 290] },
                
                // South America
                { name: 'Brazil', path: 'M240 320 L320 320 L320 420 L240 420 Z', coords: [280, 370] },
                { name: 'Argentina', path: 'M220 400 L280 400 L280 480 L220 480 Z', coords: [250, 440] },
                { name: 'Chile', path: 'M200 380 L220 380 L220 480 L200 480 Z', coords: [210, 430] },
                
                // Africa
                { name: 'South Africa', path: 'M380 400 L420 400 L420 440 L380 440 Z', coords: [400, 420] },
                { name: 'Egypt', path: 'M400 280 L420 280 L420 320 L400 320 Z', coords: [410, 300] },
                { name: 'Nigeria', path: 'M360 320 L380 320 L380 340 L360 340 Z', coords: [370, 330] },
                { name: 'Kenya', path: 'M420 340 L440 340 L440 360 L420 360 Z', coords: [430, 350] },
                { name: 'Morocco', path: 'M340 280 L360 280 L360 300 L340 300 Z', coords: [350, 290] },
                
                // Oceania
                { name: 'Australia', path: 'M620 400 L700 400 L700 460 L620 460 Z', coords: [660, 430] },
                { name: 'New Zealand', path: 'M700 440 L720 440 L720 470 L700 470 Z', coords: [710, 455] }
            ];
            
            let svgContent = `
                <svg viewBox="0 0 800 500" class="w-full h-full">
                    <!-- Ocean background -->
                    <rect width="800" height="500" fill="#bfdbfe" />
                    
                    <!-- Countries -->
            `;
            
            countries.forEach(country => {
                const carCount = countryData[country.name] || 0;
                const color = getCountryColor(carCount);
                const strokeColor = carCount > 0 ? '#374151' : '#9ca3af';
                const strokeWidth = carCount > 0 ? '2' : '1';
                
                svgContent += `
                    <path d="${country.path}" 
                          fill="${color}" 
                          stroke="${strokeColor}" 
                          stroke-width="${strokeWidth}"
                          class="country transition-all duration-200 hover:brightness-110" 
                          data-country="${country.name}" />
                `;
                
                // Add car count label for countries with cars
                if (carCount > 0) {
                    svgContent += `
                        <circle cx="${country.coords[0]}" cy="${country.coords[1]}" r="12" 
                                fill="rgba(0,0,0,0.7)" class="pointer-events-none" />
                        <text x="${country.coords[0]}" y="${country.coords[1] + 4}" 
                              text-anchor="middle" fill="white" font-size="10" font-weight="bold" 
                              class="pointer-events-none">${carCount}</text>
                    `;
                }
            });
            
            svgContent += `
                    <!-- Legend -->
                    <g transform="translate(20, 20)">
                        <rect width="200" height="80" fill="rgba(255,255,255,0.9)" stroke="#d1d5db" rx="5" />
                        <text x="10" y="20" font-size="12" font-weight="bold" fill="#374151">–ú–∞—à–∏–Ω—ã —Ç–æ–æ:</text>
                        <circle cx="20" cy="35" r="8" fill="#10b981" />
                        <text x="35" y="40" font-size="10" fill="#374151">1-5 –º–∞—à–∏–Ω</text>
                        <circle cx="20" cy="50" r="8" fill="#f59e0b" />
                        <text x="35" y="55" font-size="10" fill="#374151">6-10 –º–∞—à–∏–Ω</text>
                        <circle cx="20" cy="65" r="8" fill="#ef4444" />
                        <text x="35" y="70" font-size="10" fill="#374151">10+ –º–∞—à–∏–Ω</text>
                    </g>
                </svg>
            `;
            
            return svgContent;
        }

        function showMapTooltip(event, countryName, carCount, tooltip) {
            tooltip.innerHTML = `
                <div class="font-medium">${countryName}</div>
                <div class="text-sm">${carCount} –º–∞—à–∏–Ω</div>
                <div class="text-xs text-gray-300 mt-1">–î—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π —Ö–∞—Ä–∞—Ö—ã–Ω —Ç—É–ª–¥ –¥–∞—Ä–Ω–∞ —É—É</div>
            `;
            tooltip.classList.remove('opacity-0');
            tooltip.classList.add('opacity-100');
            updateTooltipPosition(event, tooltip);
        }

        function hideMapTooltip(tooltip) {
            tooltip.classList.remove('opacity-100');
            tooltip.classList.add('opacity-0');
        }

        function updateTooltipPosition(event, tooltip) {
            const rect = event.currentTarget.closest('#worldMap').getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            tooltip.style.left = (x + 10) + 'px';
            tooltip.style.top = (y - 10) + 'px';
        }

        function showCountryDetails(countryName) {
            const countryCars = cars.filter(car => car.country === countryName);
            
            if (countryCars.length === 0) {
                showNotification('–≠–Ω—ç —É–ª—Å–∞–¥ –º–∞—à–∏–Ω –±“Ø—Ä—Ç–≥—ç–≥–¥—ç—ç–≥“Ø–π –±–∞–π–Ω–∞.', 'info');
                return;
            }
            
            document.getElementById('countryModalTitle').textContent = `${countryName} - ${countryCars.length} –º–∞—à–∏–Ω`;
            
            const content = document.getElementById('countryDetailsContent');
            
            // Group cars by city
            const carsByCity = {};
            countryCars.forEach(car => {
                if (!carsByCity[car.city]) {
                    carsByCity[car.city] = [];
                }
                carsByCity[car.city].push(car);
            });
            
            let contentHTML = `
                <div class="mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-50 rounded-lg p-4">
                            <div class="text-2xl font-bold text-blue-600">${countryCars.length}</div>
                            <div class="text-sm text-blue-800">–ù–∏–π—Ç –º–∞—à–∏–Ω</div>
                        </div>
                        <div class="bg-green-50 rounded-lg p-4">
                            <div class="text-2xl font-bold text-green-600">${Object.keys(carsByCity).length}</div>
                            <div class="text-sm text-green-800">–•–æ—Ç/–ë–∞–π—Ä—à–∏–ª</div>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-4">
                            <div class="text-2xl font-bold text-purple-600">$${countryCars.reduce((sum, car) => sum + (car.valuation || 0), 0).toLocaleString()}</div>
                            <div class="text-sm text-purple-800">–ù–∏–π—Ç “Ø–Ω—ç–ª–≥—ç—ç</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Display cars by city
            Object.keys(carsByCity).forEach(city => {
                const cityCars = carsByCity[city];
                contentHTML += `
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="mr-2">üèôÔ∏è</span>
                            ${city} (${cityCars.length} –º–∞—à–∏–Ω)
                        </h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">–ó—É—Ä–∞–≥</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">–ú–∞—à–∏–Ω</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">“Æ–Ω—ç–ª–≥—ç—ç</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">–ù–∞—Å</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">–≠–∑—ç–º—à–∏–≥—á</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                `;
                
                cityCars.forEach(car => {
                    const owner = users.find(u => u.id === car.userId);
                    const carAge = getCarAge(car.purchaseDate);
                    const isExpired = car.usage === 'state' && carAge > 5;
                    
                    contentHTML += `
                        <tr class="${isExpired ? 'bg-red-50' : ''}">
                            <td class="px-4 py-4 whitespace-nowrap">
                                ${car.photo ? 
                                    `<img src="${car.photo}" alt="${car.brand} ${car.model}" class="w-12 h-9 object-cover rounded border">` :
                                    `<div class="w-12 h-9 bg-gray-200 rounded border flex items-center justify-center">
                                        <span class="text-gray-400 text-xs">üì∑</span>
                                    </div>`
                                }
                            </td>
                            <td class="px-4 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">${car.brand} ${car.model}</div>
                                <div class="text-sm text-gray-500">${car.color}</div>
                            </td>
                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
                                ${car.plateNumber}
                                ${isExpired ? `<div class="text-xs text-red-600 font-medium">‚ö†Ô∏è –•—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω</div>` : ''}
                            </td>
                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${getOrganizationText(car.organization)}</td>
                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">
                                ${car.valuation ? '$' + car.valuation.toLocaleString() : '“Æ–Ω—ç–ª–≥—ç—ç –±–∞–π—Ö–≥“Ø–π'}
                            </td>
                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span class="${isExpired ? 'text-red-600 font-medium' : ''}">${carAge} –∂–∏–ª</span>
                            </td>
                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">
                                ${owner ? owner.username : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á'}
                                ${car.ownerName ? `<div class="text-xs">(${car.ownerName})</div>` : ''}
                            </td>
                        </tr>
                    `;
                });
                
                contentHTML += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            });
            
            content.innerHTML = contentHTML;
            document.getElementById('countryDetailsModal').classList.remove('hidden');
        }

        // Quick action functions
        function generateReport() {
            showNotification('–¢–∞–π–ª–∞–Ω “Ø“Ø—Å–≥—ç–∂ –±–∞–π–Ω–∞...', 'info');
            
            // Simulate report generation
            setTimeout(() => {
                const reportData = {
                    totalCars: cars.length,
                    totalValuation: cars.reduce((sum, car) => sum + (car.valuation || 0), 0),
                    expiredCars: cars.filter(car => car.usage === 'state' && getCarAge(car.purchaseDate) > 5).length,
                    totalMaintenanceCost: maintenance.reduce((sum, m) => sum + m.cost, 0),
                    generatedDate: new Date().toLocaleDateString('mn-MN')
                };
                
                // Create Excel-compatible CSV content
                let csvContent = '\uFEFF'; // BOM for UTF-8
                csvContent += '–¢–≠–≠–í–†–ò–ô–ù –•–≠–†–≠–ì–°–õ–ò–ô–ù –¢–ê–ô–õ–ê–ù\n';
                csvContent += `–û–≥–Ω–æ–æ:,${reportData.generatedDate}\n\n`;
                csvContent += '–ù–ò–ô–¢ –°–¢–ê–¢–ò–°–¢–ò–ö:\n';
                csvContent += `–ù–∏–π—Ç –º–∞—à–∏–Ω:,${reportData.totalCars}\n`;
                csvContent += `–ù–∏–π—Ç “Ø–Ω—ç–ª–≥—ç—ç:,$${reportData.totalValuation.toLocaleString()}\n`;
                csvContent += `–•—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω –º–∞—à–∏–Ω:,${reportData.expiredCars}\n`;
                csvContent += `–ù–∏–π—Ç –∑–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª:,$${reportData.totalMaintenanceCost.toLocaleString()}\n\n`;
                
                // Add detailed car information
                csvContent += '–ú–ê–®–ò–ù–£–£–î–´–ù –î–≠–õ–ì–≠–†–≠–ù–ì“Æ–ô –ú–≠–î–≠–≠–õ–≠–õ:\n';
                csvContent += '–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä,–ú–∞—Ä–∫,–ó–∞–≥–≤–∞—Ä,”®–Ω–≥”©,–ë–∞–π—Ä—à–∏–ª,–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞,“Æ–Ω—ç–ª–≥—ç—ç,–ù–∞—Å,–ê—à–∏–≥–ª–∞–ª—Ç,–≠–∑—ç–º—à–∏–≥—á\n';
                
                cars.forEach(car => {
                    const user = users.find(u => u.id === car.userId);
                    const carAge = getCarAge(car.purchaseDate);
                    const location = `${car.city} ${car.country}`;
                    const organization = getOrganizationText(car.organization);
                    const valuation = car.valuation ? `$${car.valuation.toLocaleString()}` : '“Æ–Ω—ç–ª–≥—ç—ç –±–∞–π—Ö–≥“Ø–π';
                    const usage = car.usage === 'state' ? '–¢”©—Ä–∏–π–Ω ”©–º—á' : '–•—É–≤–∏–π–Ω';
                    const owner = user ? user.username : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á';
                    
                    csvContent += `${car.plateNumber},${car.brand},${car.model},${car.color},"${location}","${organization}",${valuation},${carAge} –∂–∏–ª,${usage},${owner}\n`;
                });
                
                // Add maintenance summary
                csvContent += '\n–ó–ê–°–í–ê–†/–ì–≠–ú–¢–≠–õ–ò–ô–ù –•–£–†–ê–ê–ù–ì–£–ô:\n';
                csvContent += '–ú–∞—à–∏–Ω,–¢”©—Ä”©–ª,–¢–∞–π–ª–±–∞—Ä,–ó–∞—Ä–¥–∞–ª,–û–≥–Ω–æ–æ\n';
                
                maintenance.forEach(m => {
                    const car = cars.find(c => c.id === m.carId);
                    const carInfo = car ? `${car.brand} ${car.model} (${car.plateNumber})` : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω –º–∞—à–∏–Ω';
                    const typeText = m.type === 'maintenance' ? '–ó–∞—Å–≤–∞—Ä' : '–ì—ç–º—Ç—ç–ª';
                    const description = m.description.replace(/"/g, '""'); // Escape quotes
                    
                    csvContent += `"${carInfo}",${typeText},"${description}",$${m.cost.toLocaleString()},${new Date(m.date).toLocaleDateString('mn-MN')}\n`;
                });
                
                // Create and download Excel file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `car_report_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('–¢–∞–π–ª–∞–Ω Excel —Ñ–∞–π–ª –±–æ–ª–æ–Ω –∞–º–∂–∏–ª—Ç—Ç–∞–π “Ø“Ø—Å–≥—ç–≥–¥–ª—ç—ç!', 'success');
            }, 2000);
        }

        function exportData() {
            showNotification('”®–≥”©–≥–¥”©–ª Excel —Ñ–∞–π–ª –±–æ–ª–æ–Ω —ç–∫—Å–ø–æ—Ä—Ç —Ö–∏–π–∂ –±–∞–π–Ω–∞...', 'info');
            
            setTimeout(() => {
                // Create Excel-compatible CSV content for all registered cars
                let csvContent = '\uFEFF'; // BOM for UTF-8
                csvContent += '–ë“Æ–†–¢–ì–≠–ì–î–°–≠–ù –ú–ê–®–ò–ù–£–£–î–´–ù –ë“Æ–†–≠–ù –ú–≠–î–≠–≠–õ–≠–õ\n';
                csvContent += `–≠–∫—Å–ø–æ—Ä—Ç —Ö–∏–π—Å—ç–Ω –æ–≥–Ω–æ–æ:,${new Date().toLocaleDateString('mn-MN')}\n\n`;
                
                // Cars information
                csvContent += '–ú–ê–®–ò–ù–£–£–î–´–ù –ú–≠–î–≠–≠–õ–≠–õ:\n';
                csvContent += 'ID,–£–ª—Å—ã–Ω –¥—É–≥–∞–∞—Ä,–ê—Ä–ª—ã–Ω –¥—É–≥–∞–∞—Ä,–ú–∞—Ä–∫,–ó–∞–≥–≤–∞—Ä,”®–Ω–≥”©,–ë“Ø—Å –Ω—É—Ç–∞–≥,–£–ª—Å,–•–æ—Ç,–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞,“Æ–Ω—ç–ª–≥—ç—ç,–ì“Ø–π–ª—Ç,–ù–∞—Å,–ê—à–∏–≥–ª–∞–ª—Ç,–≠–∑—ç–º—à–∏–≥—á,–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω –æ–≥–Ω–æ–æ,–ë“Ø—Ä—Ç–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ\n';
                
                cars.forEach(car => {
                    const user = users.find(u => u.id === car.userId);
                    const carAge = getCarAge(car.purchaseDate);
                    const organization = getOrganizationText(car.organization);
                    const valuation = car.valuation ? `$${car.valuation.toLocaleString()}` : '';
                    const mileage = car.mileage ? `${car.mileage} –∫–º` : '';
                    const usage = car.usage === 'state' ? '–¢”©—Ä–∏–π–Ω ”©–º—á' : '–•—É–≤–∏–π–Ω';
                    const owner = user ? user.username : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á';
                    const ownerName = car.ownerName || '';
                    const finalOwner = car.usage === 'individual' ? ownerName : owner;
                    
                    csvContent += `${car.id},"${car.plateNumber}","${car.regNumber}","${car.brand}","${car.model}","${car.color}","${car.region}","${car.country}","${car.city}","${organization}","${valuation}","${mileage}","${carAge} –∂–∏–ª","${usage}","${finalOwner}","${new Date(car.purchaseDate).toLocaleDateString('mn-MN')}","${new Date(car.registeredDate).toLocaleDateString('mn-MN')}"\n`;
                });
                
                // Maintenance information
                csvContent += '\n–ó–ê–°–í–ê–†/–ì–≠–ú–¢–≠–õ–ò–ô–ù –ú–≠–î–≠–≠–õ–≠–õ:\n';
                csvContent += 'ID,–ú–∞—à–∏–Ω—ã ID,–ú–∞—à–∏–Ω,–¢”©—Ä”©–ª,–î—ç–¥ —Ç”©—Ä”©–ª,–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂,–¢–∞–π–ª–±–∞—Ä,–ó–∞—Ä–¥–∞–ª,–¢–æ–æ—Ü–æ–æ–ª—Å–æ–Ω “Ø–Ω—ç,–û–≥–Ω–æ–æ,“Æ“Ø—Å–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ,–•—ç—Ä—ç–≥–ª—ç–≥—á\n';
                
                maintenance.forEach(m => {
                    const car = cars.find(c => c.id === m.carId);
                    const user = users.find(u => u.id === m.userId);
                    const carInfo = car ? `${car.brand} ${car.model} (${car.plateNumber})` : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω –º–∞—à–∏–Ω';
                    const typeText = m.type === 'maintenance' ? '–ó–∞—Å–≤–∞—Ä' : '–ì—ç–º—Ç—ç–ª';
                    const subcategoryTexts = {
                        'routine': '–£—Ä—Å–≥–∞–ª –∑–∞—Å–≤–∞—Ä, “Ø–π–ª—á–∏–ª–≥—ç—ç',
                        'parts': '–≠–¥ –∞–Ω–≥–∏–π–Ω –∑–∞—Å–≤–∞—Ä',
                        'parts_damage': '–≠–¥, –∞–Ω–≥–∏–π–Ω —ç–≤–¥—Ä—ç–ª, –≥—ç–º—Ç—ç–ª',
                        'body_damage': '–ë—É–¥–∞–≥, –∏—Ö –±–∏–µ–∏–π–Ω —ç–≤–¥—Ä—ç–ª –≥—ç–º—Ç—ç–ª',
                        'other': '–ë—É—Å–∞–¥'
                    };
                    const subcategoryText = subcategoryTexts[m.subcategory] || m.subcategory || '';
                    const damageStatusText = m.damageStatus === 'usable' ? '–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π' : 
                                           m.damageStatus === 'unusable' ? '–ê—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π' : '';
                    const description = (m.description || '').replace(/"/g, '""'); // Escape quotes
                    const estimatedPrice = m.estimatedPrice ? `$${m.estimatedPrice.toLocaleString()}` : '';
                    const userName = user ? user.username : '–£—Å—Ç–≥–∞–≥–¥—Å–∞–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á';
                    
                    csvContent += `${m.id},${m.carId},"${carInfo}","${typeText}","${subcategoryText}","${damageStatusText}","${description}",$${m.cost.toLocaleString()},"${estimatedPrice}","${new Date(m.date).toLocaleDateString('mn-MN')}","${new Date(m.createdDate).toLocaleDateString('mn-MN')}","${userName}"\n`;
                });
                
                // Users information (without passwords)
                csvContent += '\n–•–≠–†–≠–ì–õ–≠–ì–ß–î–ò–ô–ù –ú–≠–î–≠–≠–õ–≠–õ:\n';
                csvContent += 'ID,–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä,–ò-–º—ç–π–ª,–≠—Ä—Ö,–ë“Ø—Ä—Ç–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ\n';
                
                users.forEach(user => {
                    const role = user.isAdmin ? '–ê–¥–º–∏–Ω' : '–•—ç—Ä—ç–≥–ª—ç–≥—á';
                    csvContent += `${user.id},"${user.username}","${user.email}","${role}","${new Date(user.registeredDate).toLocaleDateString('mn-MN')}"\n`;
                });
                
                // Create and download Excel file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `car_system_full_export_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('–ë“Ø—Ö –º—ç–¥—ç—ç–ª—ç–ª Excel —Ñ–∞–π–ª –±–æ–ª–æ–Ω –∞–º–∂–∏–ª—Ç—Ç–∞–π —ç–∫—Å–ø–æ—Ä—Ç —Ö–∏–π–≥–¥–ª—ç—ç!', 'success');
            }, 1500);
        }

        function showExpiredCars() {
            showAdminSection('cars');
            // Set the expired filter
            document.getElementById('searchExpired').value = 'expired';
            performAdvancedSearch();
        }

        function showHighMaintenanceCars() {
            showNotification('”®–Ω–¥”©—Ä –∑–∞—Å–≤–∞—Ä—ã–Ω –∑–∞—Ä–¥–∞–ª—Ç–∞–π –º–∞—à–∏–Ω—É—É–¥—ã–≥ —à–∞–ª–≥–∞–∂ –±–∞–π–Ω–∞...', 'info');
            showAdminSection('valuation');
        }

        function showRecentCars() {
            showAdminSection('cars');
            showNotification('–®–∏–Ω—ç –±“Ø—Ä—Ç–≥—ç–ª“Ø“Ø–¥–∏–π–≥ —Ö–∞—Ä—É—É–ª–∂ –±–∞–π–Ω–∞...', 'info');
        }

        // Initialize the system
        updateNotificationBadge();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d3b6ec46c8152d',t:'MTc1NDg3MzE3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

